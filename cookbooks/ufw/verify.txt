-----> Starting Kitchen (v1.10.0)
-----> Verifying <default-ubuntu-1404>...
       Detected alternative framework tests for `serverspec`
       Use `/vagrant/learn-chef/cookbooks/ufw/test/integration/default/inspec` for testing
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.1_Create_Separate_Partition_for_tmp: Bash command egrep "^[^#]" /etc/fstab | awk '{print $2}' stdout should match /^\/tmp$/expected "/\n" to match /^\/tmp$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^\/tmp$/
     +/
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.2_Set_nodev_option_for_tmp_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/tmp") { print $4 }' stdout should match /nodev/expected "" to match /nodev/
     Diff:
     @@ -1,2 +1,2 @@
     -/nodev/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.3_Set_nosuid_option_for_tmp_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/tmp") { print $4 }' stdout should match /nosuid/expected "" to match /nosuid/
     Diff:
     @@ -1,2 +1,2 @@
     -/nosuid/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.4_Set_noexec_option_for_tmp_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/tmp") { print $4 }' stdout should match /noexec/expected "" to match /noexec/
     Diff:
     @@ -1,2 +1,2 @@
     -/noexec/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.5_Create_Separate_Partition_for_var: Bash command egrep "^[^#]" /etc/fstab | awk '{print $2}' stdout should match /^\/var$/expected "/\n" to match /^\/var$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^\/var$/
     +/
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.6_Bind_Mount_the_vartmp_directory_to_tmp: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/var/tmp") { print $4 }' stdout should match /bind/expected "" to match /bind/
     Diff:
     @@ -1,2 +1,2 @@
     -/bind/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.7_Create_Separate_Partition_for_varlog: Bash command egrep "^[^#]" /etc/fstab | awk '{print $2}' stdout should match /^\/var\/log$/expected "/\n" to match /^\/var\/log$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^\/var\/log$/
     +/
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.8_Create_Separate_Partition_for_varlogaudit: Bash command egrep "^[^#]" /etc/fstab | awk '{print $2}' stdout should match /^\/var\/log\/audit$/expected "/\n" to match /^\/var\/log\/audit$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^\/var\/log\/audit$/
     +/
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.9_Create_Separate_Partition_for_home: Bash command egrep "^[^#]" /etc/fstab | awk '{print $2}' stdout should match /^\/home$/expected "/\n" to match /^\/home$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^\/home$/
     +/
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.10_Add_nodev_Option_to_home: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/home") { print $4 }' stdout should match /nodev/expected "" to match /nodev/
     Diff:
     @@ -1,2 +1,2 @@
     -/nodev/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.14_Add_nodev_Option_to_runshm_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/run/shm") { print $4 }' stdout should match /nodev/expected "" to match /nodev/
     Diff:
     @@ -1,2 +1,2 @@
     -/nodev/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.15_Add_nosuid_Option_to_runshm_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/run/shm") { print $4 }' stdout should match /nosuid/expected "" to match /nosuid/
     Diff:
     @@ -1,2 +1,2 @@
     -/nosuid/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_2.16_Add_noexec_Option_to_runshm_Partition: Bash command egrep "^[^#]" /etc/fstab | awk '($2 == "/run/shm") { print $4 }' stdout should match /noexec/expected "" to match /noexec/
     Diff:
     @@ -1,2 +1,2 @@
     -/noexec/
     +""
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_2.17_Set_Sticky_Bit_on_All_World-Writable_Directories: Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \( -perm -0002 -a ! -perm -1000 \) 2>/dev/null stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_2.25_Disable_Automounting: Bash command initctl show-config autofs | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_3.1_Set_UserGroup_Owner_on_bootloader_config: Bash command stat -c "%u %g" /boot/grub/grub.cfg stdout should match /0 0/[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_3.2_Set_Permissions_on_bootloader_config: 0044 should eq "0000"
     expected: "0000"
          got: "0044"
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_3.3_Set_Boot_Loader_Password: File /boot/grub/grub.cfg content should match /^set superusers=".*"$/expected "#\n# DO NOT EDIT THIS FILE\n#\n# It is automatically generated by grub-mkconfig using templates\n# from /etc/grub.d and settings from /etc/default/grub\n#\n\n### BEGIN /etc/grub.d/00_header ###\nif [ -s $prefix/grubenv ]; then\n  set have_grubenv=true\n  load_env\nfi\nif [ \"${next_entry}\" ] ; then\n   set default=\"${next_entry}\"\n   set next_entry=\n   save_env next_entry\n   set boot_once=true\nelse\n   set default=\"0\"\nfi\n\nif [ x\"${feature_menuentry_id}\" = xy ]; then\n  menuentry_id_option=\"--id\"\nelse\n  menuentry_id_option=\"\"\nfi\n\nexport menuentry_id_option\n\nif [ \"${prev_saved_entry}\" ]; then\n  set saved_entry=\"${prev_saved_entry}\"\n  save_env saved_entry\n  set prev_saved_entry=\n  save_env prev_saved_entry\n  set boot_once=true\nfi\n\nfunction savedefault {\n  if [ -z \"${boot_once}\" ]; then\n    saved_entry=\"${chosen}\"\n    save_env saved_entry\n  fi\n}\nfunction recordfail {\n  set recordfail=1\n  if [ -n \"${have_grubenv}\" ]; then if [ -z \"${boot_once}\" ]; then save_env recordfail; fi; fi\n}\nfunction load_video {\n  if [ x$feature_all_video_module = xy ]; then\n    insmod all_video\n  else\n    insmod efi_gop\n    insmod efi_uga\n    insmod ieee1275_fb\n    insmod vbe\n    insmod vga\n    insmod video_bochs\n    insmod video_cirrus\n  fi\n}\n\nterminal_input console\nterminal_output console\nif [ \"${recordfail}\" = 1 ] ; then\n  set timeout=0\nelse\n  if [ x$feature_timeout_style = xy ] ; then\n    set timeout_style=hidden\n    set timeout=0.1\n  # Fallback hidden-timeout code in case the timeout_style feature is\n  # unavailable.\n  elif sleep --interruptible 0.1 ; then\n    set timeout=0\n  fi\nfi\n### END /etc/grub.d/00_header ###\n\n### BEGIN /etc/grub.d/05_debian_theme ###\nset menu_color_normal=white/black\nset menu_color_highlight=black/light-gray\n### END /etc/grub.d/05_debian_theme ###\n\n### BEGIN /etc/grub.d/10_linux ###\nfunction gfxmode {\n\tset gfxpayload=\"${1}\"\n\tif [ \"${1}\" = \"keep\" ]; then\n\t\tset vt_handoff=vt.handoff=7\n\telse\n\t\tset vt_handoff=\n\tfi\n}\nif [ \"${recordfail}\" != 1 ]; then\n  if [ -e ${prefix}/gfxblacklist.txt ]; then\n    if hwmatch ${prefix}/gfxblacklist.txt 3; then\n      if [ ${match} = 0 ]; then\n        set linux_gfx_mode=keep\n      else\n        set linux_gfx_mode=text\n      fi\n    else\n      set linux_gfx_mode=text\n    fi\n  else\n    set linux_gfx_mode=keep\n  fi\nelse\n  set linux_gfx_mode=text\nfi\nexport linux_gfx_mode\nmenuentry 'Ubuntu' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {\n\trecordfail\n\tload_video\n\tgfxmode $linux_gfx_mode\n\tinsmod gzio\n\tinsmod part_msdos\n\tinsmod ext2\n\tif [ x$feature_platform_search_hint = xy ]; then\n\t  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\telse\n\t  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\tfi\n\tlinux\t/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro  console=tty1 console=ttyS0\n\tinitrd\t/boot/initrd.img-3.13.0-87-generic\n}\nsubmenu 'Advanced options for Ubuntu' $menuentry_id_option 'gnulinux-advanced-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {\n\tmenuentry 'Ubuntu, with Linux 3.13.0-87-generic' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.13.0-87-generic-advanced-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {\n\t\trecordfail\n\t\tload_video\n\t\tgfxmode $linux_gfx_mode\n\t\tinsmod gzio\n\t\tinsmod part_msdos\n\t\tinsmod ext2\n\t\tif [ x$feature_platform_search_hint = xy ]; then\n\t\t  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\t\telse\n\t\t  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\t\tfi\n\t\techo\t'Loading Linux 3.13.0-87-generic ...'\n\t\tlinux\t/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro  console=tty1 console=ttyS0\n\t\techo\t'Loading initial ramdisk ...'\n\t\tinitrd\t/boot/initrd.img-3.13.0-87-generic\n\t}\n\tmenuentry 'Ubuntu, with Linux 3.13.0-87-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.13.0-87-generic-recovery-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {\n\t\trecordfail\n\t\tload_video\n\t\tinsmod gzio\n\t\tinsmod part_msdos\n\t\tinsmod ext2\n\t\tif [ x$feature_platform_search_hint = xy ]; then\n\t\t  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\t\telse\n\t\t  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48\n\t\tfi\n\t\techo\t'Loading Linux 3.13.0-87-generic ...'\n\t\tlinux\t/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro recovery nomodeset \n\t\techo\t'Loading initial ramdisk ...'\n\t\tinitrd\t/boot/initrd.img-3.13.0-87-generic\n\t}\n}\n\n### END /etc/grub.d/10_linux ###\n\n### BEGIN /etc/grub.d/20_linux_xen ###\n\n### END /etc/grub.d/20_linux_xen ###\n\n### BEGIN /etc/grub.d/30_os-prober ###\n### END /etc/grub.d/30_os-prober ###\n\n### BEGIN /etc/grub.d/30_uefi-firmware ###\n### END /etc/grub.d/30_uefi-firmware ###\n\n### BEGIN /etc/grub.d/40_custom ###\n# This file provides an easy way to add custom menu entries.  Simply type the\n# menu entries you want to add after this comment.  Be careful not to change\n# the 'exec tail' line above.\n### END /etc/grub.d/40_custom ###\n\n### BEGIN /etc/grub.d/41_custom ###\nif [ -f  ${config_directory}/custom.cfg ]; then\n  source ${config_directory}/custom.cfg\nelif [ -z \"${config_directory}\" -a -f  $prefix/custom.cfg ]; then\n  source $prefix/custom.cfg;\nfi\n### END /etc/grub.d/41_custom ###\n" to match /^set superusers=".*"$/
     Diff:
     @@ -1,2 +1,186 @@
     -/^set superusers=".*"$/
     +#
     +# DO NOT EDIT THIS FILE
     +#
     +# It is automatically generated by grub-mkconfig using templates
     +# from /etc/grub.d and settings from /etc/default/grub
     +#
     +
     +### BEGIN /etc/grub.d/00_header ###
     +if [ -s $prefix/grubenv ]; then
     +  set have_grubenv=true
     +  load_env
     +fi
     +if [ "${next_entry}" ] ; then
     +   set default="${next_entry}"
     +   set next_entry=
     +   save_env next_entry
     +   set boot_once=true
     +else
     +   set default="0"
     +fi
     +
     +if [ x"${feature_menuentry_id}" = xy ]; then
     +  menuentry_id_option="--id"
     +else
     +  menuentry_id_option=""
     +fi
     +
     +export menuentry_id_option
     +
     +if [ "${prev_saved_entry}" ]; then
     +  set saved_entry="${prev_saved_entry}"
     +  save_env saved_entry
     +  set prev_saved_entry=
     +  save_env prev_saved_entry
     +  set boot_once=true
     +fi
     +
     +function savedefault {
     +  if [ -z "${boot_once}" ]; then
     +    saved_entry="${chosen}"
     +    save_env saved_entry
     +  fi
     +}
     +function recordfail {
     +  set recordfail=1
     +  if [ -n "${have_grubenv}" ]; then if [ -z "${boot_once}" ]; then save_env recordfail; fi; fi
     +}
     +function load_video {
     +  if [ x$feature_all_video_module = xy ]; then
     +    insmod all_video
     +  else
     +    insmod efi_gop
     +    insmod efi_uga
     +    insmod ieee1275_fb
     +    insmod vbe
     +    insmod vga
     +    insmod video_bochs
     +    insmod video_cirrus
     +  fi
     +}
     +
     +terminal_input console
     +terminal_output console
     +if [ "${recordfail}" = 1 ] ; then
     +  set timeout=0
     +else
     +  if [ x$feature_timeout_style = xy ] ; then
     +    set timeout_style=hidden
     +    set timeout=0.1
     +  # Fallback hidden-timeout code in case the timeout_style feature is
     +  # unavailable.
     +  elif sleep --interruptible 0.1 ; then
     +    set timeout=0
     +  fi
     +fi
     +### END /etc/grub.d/00_header ###
     +
     +### BEGIN /etc/grub.d/05_debian_theme ###
     +set menu_color_normal=white/black
     +set menu_color_highlight=black/light-gray
     +### END /etc/grub.d/05_debian_theme ###
     +
     +### BEGIN /etc/grub.d/10_linux ###
     +function gfxmode {
     +	set gfxpayload="${1}"
     +	if [ "${1}" = "keep" ]; then
     +		set vt_handoff=vt.handoff=7
     +	else
     +		set vt_handoff=
     +	fi
     +}
     +if [ "${recordfail}" != 1 ]; then
     +  if [ -e ${prefix}/gfxblacklist.txt ]; then
     +    if hwmatch ${prefix}/gfxblacklist.txt 3; then
     +      if [ ${match} = 0 ]; then
     +        set linux_gfx_mode=keep
     +      else
     +        set linux_gfx_mode=text
     +      fi
     +    else
     +      set linux_gfx_mode=text
     +    fi
     +  else
     +    set linux_gfx_mode=keep
     +  fi
     +else
     +  set linux_gfx_mode=text
     +fi
     +export linux_gfx_mode
     +menuentry 'Ubuntu' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {
     +	recordfail
     +	load_video
     +	gfxmode $linux_gfx_mode
     +	insmod gzio
     +	insmod part_msdos
     +	insmod ext2
     +	if [ x$feature_platform_search_hint = xy ]; then
     +	  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +	else
     +	  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +	fi
     +	linux	/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro  console=tty1 console=ttyS0
     +	initrd	/boot/initrd.img-3.13.0-87-generic
     +}
     +submenu 'Advanced options for Ubuntu' $menuentry_id_option 'gnulinux-advanced-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {
     +	menuentry 'Ubuntu, with Linux 3.13.0-87-generic' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.13.0-87-generic-advanced-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {
     +		recordfail
     +		load_video
     +		gfxmode $linux_gfx_mode
     +		insmod gzio
     +		insmod part_msdos
     +		insmod ext2
     +		if [ x$feature_platform_search_hint = xy ]; then
     +		  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +		else
     +		  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +		fi
     +		echo	'Loading Linux 3.13.0-87-generic ...'
     +		linux	/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro  console=tty1 console=ttyS0
     +		echo	'Loading initial ramdisk ...'
     +		initrd	/boot/initrd.img-3.13.0-87-generic
     +	}
     +	menuentry 'Ubuntu, with Linux 3.13.0-87-generic (recovery mode)' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-3.13.0-87-generic-recovery-2c95b320-9ee8-45bf-9e4d-45fbd48c1a48' {
     +		recordfail
     +		load_video
     +		insmod gzio
     +		insmod part_msdos
     +		insmod ext2
     +		if [ x$feature_platform_search_hint = xy ]; then
     +		  search --no-floppy --fs-uuid --set=root  2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +		else
     +		  search --no-floppy --fs-uuid --set=root 2c95b320-9ee8-45bf-9e4d-45fbd48c1a48
     +		fi
     +		echo	'Loading Linux 3.13.0-87-generic ...'
     +		linux	/boot/vmlinuz-3.13.0-87-generic root=UUID=2c95b320-9ee8-45bf-9e4d-45fbd48c1a48 ro recovery nomodeset 
     +		echo	'Loading initial ramdisk ...'
     +		initrd	/boot/initrd.img-3.13.0-87-generic
     +	}
     +}
     +
     +### END /etc/grub.d/10_linux ###
     +
     +### BEGIN /etc/grub.d/20_linux_xen ###
     +
     +### END /etc/grub.d/20_linux_xen ###
     +
     +### BEGIN /etc/grub.d/30_os-prober ###
     +### END /etc/grub.d/30_os-prober ###
     +
     +### BEGIN /etc/grub.d/30_uefi-firmware ###
     +### END /etc/grub.d/30_uefi-firmware ###
     +
     +### BEGIN /etc/grub.d/40_custom ###
     +# This file provides an easy way to add custom menu entries.  Simply type the
     +# menu entries you want to add after this comment.  Be careful not to change
     +# the 'exec tail' line above.
     +### END /etc/grub.d/40_custom ###
     +
     +### BEGIN /etc/grub.d/41_custom ###
     +if [ -f  ${config_directory}/custom.cfg ]; then
     +  source ${config_directory}/custom.cfg
     +elif [ -z "${config_directory}" -a -f  $prefix/custom.cfg ]; then
     +  source $prefix/custom.cfg;
     +fi
     +### END /etc/grub.d/41_custom ###
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_3.4_Require_Authentication_for_Single-User_Mode: Bash command grep "^root:[*\!]:" /etc/shadow stdout should not match /.+/expected "root:*:16954:0:99999:7:::\n" not to match /.+/
     Diff:
     @@ -1,2 +1,2 @@
     -/.+/
     +root:*:16954:0:99999:7:::
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_4.1_Restrict_Core_Dumps: File /etc/security/limits.conf content should match /^*\s+hard\s+core\s+0/expected "# /etc/security/limits.conf\n#\n#Each line describes a limit for a user in the form:\n#\n#<domain>        <type>  <item>  <value>\n#\n#Where:\n#<domain> can be:\n#        - a user name\n#        - a group name, with @group syntax\n#        - the wildcard *, for default entry\n#        - the wildcard %, can be also used with %group syntax,\n#                 for maxlogin limit\n#        - NOTE: group and wildcard limits are not applied to root.\n#          To apply a limit to the root user, <domain> must be\n#          the literal username root.\n#\n#<type> can have the two values:\n#        - \"soft\" for enforcing the soft limits\n#        - \"hard\" for enforcing hard limits\n#\n#<item> can be one of the following:\n#        - core - limits the core file size (KB)\n#        - data - max data size (KB)\n#        - fsize - maximum filesize (KB)\n#        - memlock - max locked-in-memory address space (KB)\n#        - nofile - max number of open files\n#        - rss - max resident set size (KB)\n#        - stack - max stack size (KB)\n#        - cpu - max CPU time (MIN)\n#        - nproc - max number of processes\n#        - as - address space limit (KB)\n#        - maxlogins - max number of logins for this user\n#        - maxsyslogins - max number of logins on the system\n#        - priority - the priority to run user process with\n#        - locks - max number of file locks the user can hold\n#        - sigpending - max number of pending signals\n#        - msgqueue - max memory used by POSIX message queues (bytes)\n#        - nice - max nice priority allowed to raise to values: [-20, 19]\n#        - rtprio - max realtime priority\n#        - chroot - change root to directory (Debian-specific)\n#\n#<domain>      <type>  <item>         <value>\n#\n\n#*               soft    core            0\n#root            hard    core            100000\n#*               hard    rss             10000\n\#@student        hard    nproc           20\n\#@faculty        soft    nproc           20\n\#@faculty        hard    nproc           50\n#ftp             hard    nproc           0\n#ftp             -       chroot          /ftp\n\#@student        -       maxlogins       4\n\n# End of file\n" to match /^*\s+hard\s+core\s+0/
     Diff:
     @@ -1,2 +1,57 @@
     -/^*\s+hard\s+core\s+0/
     +# /etc/security/limits.conf
     +#
     +#Each line describes a limit for a user in the form:
     +#
     +#<domain>        <type>  <item>  <value>
     +#
     +#Where:
     +#<domain> can be:
     +#        - a user name
     +#        - a group name, with @group syntax
     +#        - the wildcard *, for default entry
     +#        - the wildcard %, can be also used with %group syntax,
     +#                 for maxlogin limit
     +#        - NOTE: group and wildcard limits are not applied to root.
     +#          To apply a limit to the root user, <domain> must be
     +#          the literal username root.
     +#
     +#<type> can have the two values:
     +#        - "soft" for enforcing the soft limits
     +#        - "hard" for enforcing hard limits
     +#
     +#<item> can be one of the following:
     +#        - core - limits the core file size (KB)
     +#        - data - max data size (KB)
     +#        - fsize - maximum filesize (KB)
     +#        - memlock - max locked-in-memory address space (KB)
     +#        - nofile - max number of open files
     +#        - rss - max resident set size (KB)
     +#        - stack - max stack size (KB)
     +#        - cpu - max CPU time (MIN)
     +#        - nproc - max number of processes
     +#        - as - address space limit (KB)
     +#        - maxlogins - max number of logins for this user
     +#        - maxsyslogins - max number of logins on the system
     +#        - priority - the priority to run user process with
     +#        - locks - max number of file locks the user can hold
     +#        - sigpending - max number of pending signals
     +#        - msgqueue - max memory used by POSIX message queues (bytes)
     +#        - nice - max nice priority allowed to raise to values: [-20, 19]
     +#        - rtprio - max realtime priority
     +#        - chroot - change root to directory (Debian-specific)
     +#
     +#<domain>      <type>  <item>         <value>
     +#
     +
     +#*               soft    core            0
     +#root            hard    core            100000
     +#*               hard    rss             10000
     +#@student        hard    nproc           20
     +#@faculty        soft    nproc           20
     +#@faculty        hard    nproc           50
     +#ftp             hard    nproc           0
     +#ftp             -       chroot          /ftp
     +#@student        -       maxlogins       4
     +
     +# End of file
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_4.2_Enable_XDNX_Support_on_32-bit_x86_Systems: Bash command dmesg | grep NX stdout should match /NX \(Execute Disable\) protection: active/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_4.3_Enable_Randomized_Virtual_Memory_Region_Placement: 2 should eq "2"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_4.4_Disable_Prelink: Bash command dpkg -s prelink | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.1_Ensure_NIS_is_not_installed: Bash command dpkg -s nis | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.2_Ensure_rsh_server_is_not_enabled: Bash command egrep "^shell" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.3_Ensure_rsh_client_is_not_installed: Bash command dpkg -s rsh-client | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.4_Ensure_talk_server_is_not_enabled: Bash command egrep "^talk" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.5_Ensure_talk_client_is_not_installed: Bash command dpkg -s talk | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.6_Ensure_telnet_server_is_not_enabled: Bash command egrep "^telnet" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.7_Ensure_tftp-server_is_not_enabled: Bash command egrep "^tftp" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.1.8_Ensure_xinetd_is_not_enabled: Bash command initctl show-config xinetd | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.2_Ensure_chargen_is_not_enabled: Bash command egrep "^chargen" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.3_Ensure_daytime_is_not_enabled: Bash command chkconfig --list daytime | egrep "on" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.4_Ensure_echo_is_not_enabled: Bash command egrep "^echo" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.5_Ensure_discard_is_not_enabled: Bash command egrep "^discard" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_5.6_Ensure_time_is_not_enabled: Bash command egrep "^time" /etc/inetd.conf exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.1_Ensure_the_X_Window_system_is_not_installed: Bash command dpkg -l xserver-xorg-core* stdout should not match /^ii/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.2_Ensure_Avahi_Server_is_not_enabled: Bash command initctl show-config avahi-daemon | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.3_Ensure_print_server_is_not_enabled: Bash command initctl show-config cups | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.4_Ensure_DHCP_Server_is_not_enabled: Bash command initctl show-config isc-dhcp-server | egrep "^\s*start" exit_status should not eq 0[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_6.5_Configure_Network_Time_Protocol_NTP: File /etc/ntp.conf content should match /^\s*restrict\s+-4\s+default(?=[^#]*\s+kod)(?=[^#]*\s+nomodify)(?=[^#]*\s+notrap)(?=[^#]*\s+nopeer)(?=[^#]*\s+noquery)(\s+kod|\s+nomodify|\s+notrap|\s+nopeer|\s+noquery)*\s*(?:#.*)?$/expected nil to match /^\s*restrict\s+-4\s+default(?=[^#]*\s+kod)(?=[^#]*\s+nomodify)(?=[^#]*\s+notrap)(?=[^#]*\s+nopeer)(?=[^#]*\s+noquery)(\s+kod|\s+nomodify|\s+notrap|\s+nopeer|\s+noquery)*\s*(?:#.*)?$/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.6_Ensure_LDAP_is_not_enabled: Bash command dpkg -s slapd | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.7_Ensure_NFS_and_RPC_are_not_enabled: Bash command ls /etc/rc*.d/S*nfs-kernel-server exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.8_Ensure_DNS_Server_is_not_enabled: Bash command ls /etc/rc*.d/S*bind9 exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.9_Ensure_FTP_Server_is_not_enabled: Bash command initctl show-config vsftpd | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.10_Ensure_HTTP_Server_is_not_enabled: Bash command ls /etc/rc*.d/S*apache2 exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.11_Ensure_IMAP_and_POP_server_is_not_enabled: Bash command initctl show-config dovecot | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.12_Ensure_Samba_is_not_enabled: Bash command initctl show-config smbd | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.13_Ensure_HTTP_Proxy_Server_is_not_enabled: Bash command initctl show-config squid3 | egrep "^\s*start" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.14_Ensure_SNMP_Server_is_not_enabled: Bash command ls /etc/rc*.d/S*snmpd exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.15_Configure_Mail_Transfer_Agent_for_Local-Only_Mode: Bash command netstat -an | grep LIST | awk '($4 != "127.0.0.1:25" && $4 != "::1:25") { print $4 }' | grep ":25$" stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.16_Ensure_rsync_service_is_not_enabled: File /etc/default/rsync content should match /^RSYNC_ENABLE=false/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_6.17_Ensure_Biosdevname_is_not_enabled: Bash command dpkg -s biosdevname | egrep "^Status:\ install" exit_status should not eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.1.1_Disable_IP_Forwarding: 0 should eq "0"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.1.2_Disable_Send_Packet_Redirects: 1 should eq "0"
     expected: "0"
          got: "1"
     
     (compared using ==)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.2.1_Disable_Source_Routed_Packet_Acceptance: 0 should eq "0"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.2.2_Disable_ICMP_Redirect_Acceptance: 0 should eq "0"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.2.3_Disable_Secure_ICMP_Redirect_Acceptance: 1 should eq "0"
     expected: "0"
          got: "1"
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.2.4_Log_Suspicious_Packets: 0 should eq "1"
     expected: "1"
          got: "0"
     
     (compared using ==)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.2.5_Enable_Ignore_Broadcast_Requests: 1 should eq "1"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.2.6_Enable_Bad_Error_Message_Protection: 1 should eq "1"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.2.7_Enable_RFC-recommended_Source_Route_Validation: 1 should eq "1"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.2.8_Enable_TCP_SYN_Cookies: 0 should eq "1"
     expected: "1"
          got: "0"
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.3.1_Disable_IPv6_Router_Advertisements: 1 should eq "0"
     expected: "0"
          got: "1"
     
     (compared using ==)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.3.2_Disable_IPv6_Redirect_Acceptance: 0 should eq "0"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.3.3_Disable_IPv6: Bash command ip addr | grep inet6 stdout should not match /.+/expected "    inet6 ::1/128 scope host \n    inet6 fe80::43a:71ff:feef:1bcb/64 scope link \n" not to match /.+/
     Diff:
     @@ -1,2 +1,3 @@
     -/.+/
     +    inet6 ::1/128 scope host 
     +    inet6 fe80::43a:71ff:feef:1bcb/64 scope link 
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.4.1_Install_TCP_Wrappers: Bash command dpkg -s tcpd | egrep "^Status:\ install" exit_status should eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.4.3_Verify_Permissions_on_etchosts.allow: 0000 should eq "0000"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.4.5_Verify_Permissions_on_etchosts.deny: 0000 should eq "0000"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.5.1_Disable_DCCP: Bash command modprobe -n -v dccp stdout should match /^install \/bin\/true/expected "insmod /lib/modules/3.13.0-87-generic/kernel/net/dccp/dccp.ko \n" to match /^install \/bin\/true/
     Diff:
     @@ -1,2 +1,2 @@
     -/^install \/bin\/true/
     +insmod /lib/modules/3.13.0-87-generic/kernel/net/dccp/dccp.ko 
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.5.2_Disable_SCTP: Bash command modprobe -n -v sctp stdout should match /^install \/bin\/true/expected "insmod /lib/modules/3.13.0-87-generic/kernel/lib/libcrc32c.ko \ninsmod /lib/modules/3.13.0-87-generic/kernel/net/sctp/sctp.ko \n" to match /^install \/bin\/true/
     Diff:
     @@ -1,2 +1,3 @@
     -/^install \/bin\/true/
     +insmod /lib/modules/3.13.0-87-generic/kernel/lib/libcrc32c.ko 
     +insmod /lib/modules/3.13.0-87-generic/kernel/net/sctp/sctp.ko 
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.5.3_Disable_RDS: Bash command modprobe -n -v rds stdout should match /^install \/bin\/true/expected "" to match /^install \/bin\/true/
     Diff:
     @@ -1,2 +1,2 @@
     -/^install \/bin\/true/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_7.5.4_Disable_TIPC: Bash command modprobe -n -v tipc stdout should match /^install \/bin\/true/expected "insmod /lib/modules/3.13.0-87-generic/kernel/net/tipc/tipc.ko \n" to match /^install \/bin\/true/
     Diff:
     @@ -1,2 +1,2 @@
     -/^install \/bin\/true/
     +insmod /lib/modules/3.13.0-87-generic/kernel/net/tipc/tipc.ko 
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_7.7_Ensure_Firewall_is_active: Bash command ufw status stdout should match /^Status: active$/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_8.2.1_Install_the_rsyslog_package: Bash command dpkg -s rsyslog | egrep "^Status:\ install" exit_status should eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_8.2.2_Ensure_the_rsyslog_Service_is_activated: Bash command initctl show-config rsyslog | egrep "^\s*start" exit_status should eq 0[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_8.2.4_Create_and_Set_Permissions_on_rsyslog_Log_Files: Bash command find `awk '/^ *[^#$]/ { print $2 }' /etc/rsyslog.conf /etc/rsyslog.d/* | egrep -o "/.*"` ! -user root stdout should not match /.+/expected "/var/log/auth.log\n/var/log/syslog\n/var/log/kern.log\n" not to match /.+/
     Diff:
     @@ -1,2 +1,4 @@
     -/.+/
     +/var/log/auth.log
     +/var/log/syslog
     +/var/log/kern.log
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_8.2.5_Configure_rsyslog_to_Send_Logs_to_a_Remote_Log_Host: File /etc/rsyslog.conf content should match /^\*\.\*\s+@/expected "#  /etc/rsyslog.conf\tConfiguration file for rsyslog.\n#\n#\t\t\tFor more information see\n#\t\t\t/usr/share/doc/rsyslog-doc/html/rsyslog_conf.html\n#\n#  Default logging rules can be found in /etc/rsyslog.d/50-default.conf\n\n\n#################\n#### MODULES ####\n#################\n\n$ModLoad imuxsock # provides support for local system logging\n$ModLoad imklog   # provides kernel logging support\n\#$ModLoad immark  # provides --MARK-- message capability\n\n# provides UDP syslog reception\n\#$ModLoad imudp\n\#$UDPServerRun 514\n\n# provides TCP syslog reception\n\#$ModLoad imtcp\n\#$InputTCPServerRun 514\n\n# Enable non-kernel facility klog messages\n$KLogPermitNonKernelFacility on\n\n###########################\n#### GLOBAL DIRECTIVES ####\n###########################\n\n#\n# Use traditional timestamp format.\n# To enable high precision timestamps, comment out the following line.\n#\n$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat\n\n# Filter duplicated messages\n$RepeatedMsgReduction on\n\n#\n# Set the default permissions for all log files.\n#\n$FileOwner syslog\n$FileGroup adm\n$FileCreateMode 0640\n$DirCreateMode 0755\n$Umask 0022\n$PrivDropToUser syslog\n$PrivDropToGroup syslog\n\n#\n# Where to place spool and state files\n#\n$WorkDirectory /var/spool/rsyslog\n\n#\n# Include all config files in /etc/rsyslog.d/\n#\n$IncludeConfig /etc/rsyslog.d/*.conf\n\n" to match /^\*\.\*\s+@/
     Diff:
     @@ -1,2 +1,61 @@
     -/^\*\.\*\s+@/
     +#  /etc/rsyslog.conf	Configuration file for rsyslog.
     +#
     +#			For more information see
     +#			/usr/share/doc/rsyslog-doc/html/rsyslog_conf.html
     +#
     +#  Default logging rules can be found in /etc/rsyslog.d/50-default.conf
     +
     +
     +#################
     +#### MODULES ####
     +#################
     +
     +$ModLoad imuxsock # provides support for local system logging
     +$ModLoad imklog   # provides kernel logging support
     +#$ModLoad immark  # provides --MARK-- message capability
     +
     +# provides UDP syslog reception
     +#$ModLoad imudp
     +#$UDPServerRun 514
     +
     +# provides TCP syslog reception
     +#$ModLoad imtcp
     +#$InputTCPServerRun 514
     +
     +# Enable non-kernel facility klog messages
     +$KLogPermitNonKernelFacility on
     +
     +###########################
     +#### GLOBAL DIRECTIVES ####
     +###########################
     +
     +#
     +# Use traditional timestamp format.
     +# To enable high precision timestamps, comment out the following line.
     +#
     +$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat
     +
     +# Filter duplicated messages
     +$RepeatedMsgReduction on
     +
     +#
     +# Set the default permissions for all log files.
     +#
     +$FileOwner syslog
     +$FileGroup adm
     +$FileCreateMode 0640
     +$DirCreateMode 0755
     +$Umask 0022
     +$PrivDropToUser syslog
     +$PrivDropToGroup syslog
     +
     +#
     +# Where to place spool and state files
     +#
     +$WorkDirectory /var/spool/rsyslog
     +
     +#
     +# Include all config files in /etc/rsyslog.d/
     +#
     +$IncludeConfig /etc/rsyslog.d/*.conf
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.1_Enable_cron_Daemon: Bash command initctl show-config cron | egrep "^\s*start" exit_status should eq 0[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.2_Set_UserGroup_Owner_and_Permission_on_etccrontab: Bash command stat -c "%u %g" /etc/crontab stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.3_Set_UserGroup_Owner_and_Permission_on_etccron.hourly: Bash command stat -c "%u %g" /etc/cron.hourly stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.4_Set_UserGroup_Owner_and_Permission_on_etccron.daily: Bash command stat -c "%u %g" /etc/cron.daily stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.5_Set_UserGroup_Owner_and_Permission_on_etccron.weekly: Bash command stat -c "%u %g" /etc/cron.weekly stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.6_Set_UserGroup_Owner_and_Permission_on_etccron.monthly: Bash command stat -c "%u %g" /etc/cron.monthly stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.7_Set_UserGroup_Owner_and_Permission_on_etccron.d: Bash command stat -c "%u %g" /etc/cron.d stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.1.8_Restrict_atcron_to_Authorized_Users: Bash command stat /etc/cron.deny exit_status should not eq 0[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.2.1_Set_Password_Creation_Requirement_Parameters_Using_pam_cracklib: Bash command egrep -v "^[[:space:]]*#" /etc/pam.d/common-password | egrep "pam_cracklib.so" | sed -e 's/#.*//' | tr -s '\t ' '\n' | awk -F = '/^retry/ { if ($2 <= 3) print $2 }' stdout should match /.+/expected "" to match /.+/
     Diff:
     @@ -1,2 +1,2 @@
     -/.+/
     +""
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.2.2_Set_Lockout_for_Failed_Password_Attempts: File /etc/pam.d/login content should match /^auth\s+required\s+pam_tally2.so\s+onerr=fail\s+audit\s+silent\s+deny=5\s+unlock_time=900$/expected "#\n# The PAM configuration file for the Shadow `login' service\n#\n\n# Enforce a minimal delay in case of failure (in microseconds).\n# (Replaces the `FAIL_DELAY' setting from login.defs)\n# Note that other modules may require another minimal delay. (for example,\n# to disable any delay, you should add the nodelay option to pam_unix)\nauth       optional   pam_faildelay.so  delay=3000000\n\n# Outputs an issue file prior to each login prompt (Replaces the\n# ISSUE_FILE option from login.defs). Uncomment for use\n# auth       required   pam_issue.so issue=/etc/issue\n\n# Disallows root logins except on tty's listed in /etc/securetty\n# (Replaces the `CONSOLE' setting from login.defs)\n#\n# With the default control of this module:\n#   [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die]\n# root will not be prompted for a password on insecure lines.\n# if an invalid username is entered, a password is prompted (but login\n# will eventually be rejected)\n#\n# You can change it to a \"requisite\" module if you think root may mis-type\n# her login and should not be prompted for a password in that case. But\n# this will leave the system as vulnerable to user enumeration attacks.\n#\n# You can change it to a \"required\" module if you think it permits to\n# guess valid user names of your system (invalid user names are considered\n# as possibly being root on insecure lines), but root passwords may be\n# communicated over insecure lines.\nauth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so\n\n# Disallows other than root logins when /etc/nologin exists\n# (Replaces the `NOLOGINS_FILE' option from login.defs)\nauth       requisite  pam_nologin.so\n\n# SELinux needs to be the first session rule. This ensures that any \n# lingering context has been cleared. Without out this it is possible \n# that a module could execute code in the wrong domain.\n# When the module is present, \"required\" would be sufficient (When SELinux\n# is disabled, this returns success.)\nsession [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close\n\n# This module parses environment configuration file(s)\n# and also allows you to use an extended config\n# file /etc/security/pam_env.conf.\n# \n# parsing /etc/environment needs \"readenv=1\"\nsession       required   pam_env.so readenv=1\n# locale variables are also kept into /etc/default/locale in etch\n# reading this file *in addition to /etc/environment* does not hurt\nsession       required   pam_env.so readenv=1 envfile=/etc/default/locale\n\n# Standard Un*x authentication.\n@include common-auth\n\n# This allows certain extra groups to be granted to a user\n# based on things like time of day, tty, service, and user.\n# Please edit /etc/security/group.conf to fit your needs\n# (Replaces the `CONSOLE_GROUPS' option in login.defs)\nauth       optional   pam_group.so\n\n# Uncomment and edit /etc/security/time.conf if you need to set\n# time restrainst on logins.\n# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs\n# as well as /etc/porttime)\n# account    requisite  pam_time.so\n\n# Uncomment and edit /etc/security/access.conf if you need to\n# set access limits.\n# (Replaces /etc/login.access file)\n# account  required       pam_access.so\n\n# Sets up user limits according to /etc/security/limits.conf\n# (Replaces the use of /etc/limits in old login)\nsession    required   pam_limits.so\n\n# Prints the last login info upon succesful login\n# (Replaces the `LASTLOG_ENAB' option from login.defs)\nsession    optional   pam_lastlog.so\n\n# Prints the message of the day upon succesful login.\n# (Replaces the `MOTD_FILE' option in login.defs)\n# This includes a dynamically generated part from /run/motd.dynamic\n# and a static (admin-editable) part from /etc/motd.\nsession    optional   pam_motd.so  motd=/run/motd.dynamic noupdate\nsession    optional   pam_motd.so\n\n# Prints the status of the user's mailbox upon succesful login\n# (Replaces the `MAIL_CHECK_ENAB' option from login.defs). \n#\n# This also defines the MAIL environment variable\n# However, userdel also needs MAIL_DIR and MAIL_FILE variables\n# in /etc/login.defs to make sure that removing a user \n# also removes the user's mail spool file.\n# See comments in /etc/login.defs\nsession    optional   pam_mail.so standard\n\n# Standard Un*x account and session\n@include common-account\n@include common-session\n@include common-password\n\n# SELinux needs to intervene at login time to ensure that the process\n# starts in the proper default security context. Only sessions which are\n# intended to run in the user's context should be run after this.\nsession [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open\n# When the module is present, \"required\" would be sufficient (When SELinux\n# is disabled, this returns success.)\n" to match /^auth\s+required\s+pam_tally2.so\s+onerr=fail\s+audit\s+silent\s+deny=5\s+unlock_time=900$/
     Diff:
     @@ -1,2 +1,111 @@
     -/^auth\s+required\s+pam_tally2.so\s+onerr=fail\s+audit\s+silent\s+deny=5\s+unlock_time=900$/
     +#
     +# The PAM configuration file for the Shadow `login' service
     +#
     +
     +# Enforce a minimal delay in case of failure (in microseconds).
     +# (Replaces the `FAIL_DELAY' setting from login.defs)
     +# Note that other modules may require another minimal delay. (for example,
     +# to disable any delay, you should add the nodelay option to pam_unix)
     +auth       optional   pam_faildelay.so  delay=3000000
     +
     +# Outputs an issue file prior to each login prompt (Replaces the
     +# ISSUE_FILE option from login.defs). Uncomment for use
     +# auth       required   pam_issue.so issue=/etc/issue
     +
     +# Disallows root logins except on tty's listed in /etc/securetty
     +# (Replaces the `CONSOLE' setting from login.defs)
     +#
     +# With the default control of this module:
     +#   [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die]
     +# root will not be prompted for a password on insecure lines.
     +# if an invalid username is entered, a password is prompted (but login
     +# will eventually be rejected)
     +#
     +# You can change it to a "requisite" module if you think root may mis-type
     +# her login and should not be prompted for a password in that case. But
     +# this will leave the system as vulnerable to user enumeration attacks.
     +#
     +# You can change it to a "required" module if you think it permits to
     +# guess valid user names of your system (invalid user names are considered
     +# as possibly being root on insecure lines), but root passwords may be
     +# communicated over insecure lines.
     +auth [success=ok new_authtok_reqd=ok ignore=ignore user_unknown=bad default=die] pam_securetty.so
     +
     +# Disallows other than root logins when /etc/nologin exists
     +# (Replaces the `NOLOGINS_FILE' option from login.defs)
     +auth       requisite  pam_nologin.so
     +
     +# SELinux needs to be the first session rule. This ensures that any 
     +# lingering context has been cleared. Without out this it is possible 
     +# that a module could execute code in the wrong domain.
     +# When the module is present, "required" would be sufficient (When SELinux
     +# is disabled, this returns success.)
     +session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close
     +
     +# This module parses environment configuration file(s)
     +# and also allows you to use an extended config
     +# file /etc/security/pam_env.conf.
     +# 
     +# parsing /etc/environment needs "readenv=1"
     +session       required   pam_env.so readenv=1
     +# locale variables are also kept into /etc/default/locale in etch
     +# reading this file *in addition to /etc/environment* does not hurt
     +session       required   pam_env.so readenv=1 envfile=/etc/default/locale
     +
     +# Standard Un*x authentication.
     +@include common-auth
     +
     +# This allows certain extra groups to be granted to a user
     +# based on things like time of day, tty, service, and user.
     +# Please edit /etc/security/group.conf to fit your needs
     +# (Replaces the `CONSOLE_GROUPS' option in login.defs)
     +auth       optional   pam_group.so
     +
     +# Uncomment and edit /etc/security/time.conf if you need to set
     +# time restrainst on logins.
     +# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
     +# as well as /etc/porttime)
     +# account    requisite  pam_time.so
     +
     +# Uncomment and edit /etc/security/access.conf if you need to
     +# set access limits.
     +# (Replaces /etc/login.access file)
     +# account  required       pam_access.so
     +
     +# Sets up user limits according to /etc/security/limits.conf
     +# (Replaces the use of /etc/limits in old login)
     +session    required   pam_limits.so
     +
     +# Prints the last login info upon succesful login
     +# (Replaces the `LASTLOG_ENAB' option from login.defs)
     +session    optional   pam_lastlog.so
     +
     +# Prints the message of the day upon succesful login.
     +# (Replaces the `MOTD_FILE' option in login.defs)
     +# This includes a dynamically generated part from /run/motd.dynamic
     +# and a static (admin-editable) part from /etc/motd.
     +session    optional   pam_motd.so  motd=/run/motd.dynamic noupdate
     +session    optional   pam_motd.so
     +
     +# Prints the status of the user's mailbox upon succesful login
     +# (Replaces the `MAIL_CHECK_ENAB' option from login.defs). 
     +#
     +# This also defines the MAIL environment variable
     +# However, userdel also needs MAIL_DIR and MAIL_FILE variables
     +# in /etc/login.defs to make sure that removing a user 
     +# also removes the user's mail spool file.
     +# See comments in /etc/login.defs
     +session    optional   pam_mail.so standard
     +
     +# Standard Un*x account and session
     +@include common-account
     +@include common-session
     +@include common-password
     +
     +# SELinux needs to intervene at login time to ensure that the process
     +# starts in the proper default security context. Only sessions which are
     +# intended to run in the user's context should be run after this.
     +session [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open
     +# When the module is present, "required" would be sufficient (When SELinux
     +# is disabled, this returns success.)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.2.3_Limit_Password_Reuse: File /etc/pam.d/common-password content should match /^[^#]*remember/expected "#\n# /etc/pam.d/common-password - password-related modules common to all services\n#\n# This file is included from other service-specific PAM config files,\n# and should contain a list of modules that define the services to be\n# used to change user passwords.  The default is pam_unix.\n\n# Explanation of pam_unix options:\n#\n# The \"sha512\" option enables salted SHA512 passwords.  Without this option,\n# the default is Unix crypt.  Prior releases used the option \"md5\".\n#\n# The \"obscure\" option replaces the old `OBSCURE_CHECKS_ENAB' option in\n# login.defs.\n#\n# See the pam_unix manpage for other options.\n\n# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.\n# To take advantage of this, it is recommended that you configure any\n# local modules either before or after the default block, and use\n# pam-auth-update to manage selection of other modules.  See\n# pam-auth-update(8) for details.\n\n# here are the per-package modules (the \"Primary\" block)\npassword\t[success=1 default=ignore]\tpam_unix.so obscure sha512\n# here's the fallback if no module succeeds\npassword\trequisite\t\t\tpam_deny.so\n# prime the stack with a positive return value if there isn't one already;\n# this avoids us returning an error just because nothing sets a success code\n# since the modules above will each just jump around\npassword\trequired\t\t\tpam_permit.so\n# and here are more per-package modules (the \"Additional\" block)\n# end of pam-auth-update config\n" to match /^[^#]*remember/
     Diff:
     @@ -1,2 +1,34 @@
     -/^[^#]*remember/
     +#
     +# /etc/pam.d/common-password - password-related modules common to all services
     +#
     +# This file is included from other service-specific PAM config files,
     +# and should contain a list of modules that define the services to be
     +# used to change user passwords.  The default is pam_unix.
     +
     +# Explanation of pam_unix options:
     +#
     +# The "sha512" option enables salted SHA512 passwords.  Without this option,
     +# the default is Unix crypt.  Prior releases used the option "md5".
     +#
     +# The "obscure" option replaces the old `OBSCURE_CHECKS_ENAB' option in
     +# login.defs.
     +#
     +# See the pam_unix manpage for other options.
     +
     +# As of pam 1.0.1-6, this file is managed by pam-auth-update by default.
     +# To take advantage of this, it is recommended that you configure any
     +# local modules either before or after the default block, and use
     +# pam-auth-update to manage selection of other modules.  See
     +# pam-auth-update(8) for details.
     +
     +# here are the per-package modules (the "Primary" block)
     +password	[success=1 default=ignore]	pam_unix.so obscure sha512
     +# here's the fallback if no module succeeds
     +password	requisite			pam_deny.so
     +# prime the stack with a positive return value if there isn't one already;
     +# this avoids us returning an error just because nothing sets a success code
     +# since the modules above will each just jump around
     +password	required			pam_permit.so
     +# and here are more per-package modules (the "Additional" block)
     +# end of pam-auth-update config
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.3.1_Set_SSH_Protocol_to_2: 2 should eq "2"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.3.2_Set_LogLevel_to_INFO: INFO should eq "INFO"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.3_Set_Permissions_on_etcsshsshd_config: Bash command stat -L -c "%a %u %g" /etc/ssh/sshd_config stdout should match /.00 0 0/expected "644 0 0\n" to match /.00 0 0/
     Diff:
     @@ -1,2 +1,2 @@
     -/.00 0 0/
     +644 0 0
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.4_Disable_SSH_X11_Forwarding: yes should eq "no"
     expected: "no"
          got: "yes"
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.5_Set_SSH_MaxAuthTries_to_4_or_Less:  should cmp
     expected it to be <= 4
          got: 
     
     (compared using `cmp` matcher)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.3.6_Set_SSH_IgnoreRhosts_to_Yes: yes should eq "yes"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.3.7_Set_SSH_HostbasedAuthentication_to_No: no should eq "no"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.8_Disable_SSH_Root_Login: without-password should eq "no"
     expected: "no"
          got: "without-password"
     
     (compared using ==)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_9.3.9_Set_SSH_PermitEmptyPasswords_to_No: no should eq "no"[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.10_Do_Not_Allow_Users_to_Set_Environment_Options:  should eq "no"
     expected: "no"
          got: nil
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.11_Use_Only_Approved_Cipher_in_Counter_Mode:  should eq "aes128-ctr,aes192-ctr,aes256-ctr"
     expected: "aes128-ctr,aes192-ctr,aes256-ctr"
          got: nil
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.12_Set_Idle_Timeout_Interval_for_User_Login:  should eq "300"
     expected: "300"
          got: nil
     
     (compared using ==)
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.13_Limit_Access_via_SSH: File /etc/ssh/sshd_config content should match /^\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\s+.*/expected "# Package generated configuration file\n# See the sshd_config(5) manpage for details\n\n# What ports, IPs and protocols we listen for\nPort 22\n# Use these options to restrict which interfaces/protocols sshd will bind to\n#ListenAddress ::\n#ListenAddress 0.0.0.0\nProtocol 2\n# HostKeys for protocol version 2\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_dsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\n#Privilege Separation is turned on for security\nUsePrivilegeSeparation yes\n\n# Lifetime and size of ephemeral version 1 server key\nKeyRegenerationInterval 3600\nServerKeyBits 1024\n\n# Logging\nSyslogFacility AUTH\nLogLevel INFO\n\n# Authentication:\nLoginGraceTime 120\nPermitRootLogin without-password\nStrictModes yes\n\nRSAAuthentication yes\nPubkeyAuthentication yes\n#AuthorizedKeysFile\t%h/.ssh/authorized_keys\n\n# Don't read the user's ~/.rhosts and ~/.shosts files\nIgnoreRhosts yes\n# For this to work you will also need host keys in /etc/ssh_known_hosts\nRhostsRSAAuthentication no\n# similar for protocol version 2\nHostbasedAuthentication no\n# Uncomment if you don't trust ~/.ssh/known_hosts for RhostsRSAAuthentication\n#IgnoreUserKnownHosts yes\n\n# To enable empty passwords, change to yes (NOT RECOMMENDED)\nPermitEmptyPasswords no\n\n# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication no\n\n# Change to no to disable tunnelled clear text passwords\nPasswordAuthentication no\n\n# Kerberos options\n#KerberosAuthentication no\n#KerberosGetAFSToken no\n#KerberosOrLocalPasswd yes\n#KerberosTicketCleanup yes\n\n# GSSAPI options\n#GSSAPIAuthentication no\n#GSSAPICleanupCredentials yes\n\nX11Forwarding yes\nX11DisplayOffset 10\nPrintMotd no\nPrintLastLog yes\nTCPKeepAlive yes\n#UseLogin no\n\n#MaxStartups 10:30:60\n#Banner /etc/issue.net\n\n# Allow client to pass locale environment variables\nAcceptEnv LANG LC_*\n\nSubsystem sftp /usr/lib/openssh/sftp-server\n\n# Set this to 'yes' to enable PAM authentication, account processing,\n# and session processing. If this is enabled, PAM authentication will\n# be allowed through the ChallengeResponseAuthentication and\n# PasswordAuthentication.  Depending on your PAM configuration,\n# PAM authentication via ChallengeResponseAuthentication may bypass\n# the setting of \"PermitRootLogin without-password\".\n# If you just want the PAM account and session checks to run without\n# PAM authentication, then enable this but set PasswordAuthentication\n# and ChallengeResponseAuthentication to 'no'.\nUsePAM yes\n" to match /^\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\s+.*/
     Diff:
     @@ -1,2 +1,89 @@
     -/^\s*(AllowUsers|AllowGroups|DenyUsers|DenyGroups)\s+.*/
     +# Package generated configuration file
     +# See the sshd_config(5) manpage for details
     +
     +# What ports, IPs and protocols we listen for
     +Port 22
     +# Use these options to restrict which interfaces/protocols sshd will bind to
     +#ListenAddress ::
     +#ListenAddress 0.0.0.0
     +Protocol 2
     +# HostKeys for protocol version 2
     +HostKey /etc/ssh/ssh_host_rsa_key
     +HostKey /etc/ssh/ssh_host_dsa_key
     +HostKey /etc/ssh/ssh_host_ecdsa_key
     +HostKey /etc/ssh/ssh_host_ed25519_key
     +#Privilege Separation is turned on for security
     +UsePrivilegeSeparation yes
     +
     +# Lifetime and size of ephemeral version 1 server key
     +KeyRegenerationInterval 3600
     +ServerKeyBits 1024
     +
     +# Logging
     +SyslogFacility AUTH
     +LogLevel INFO
     +
     +# Authentication:
     +LoginGraceTime 120
     +PermitRootLogin without-password
     +StrictModes yes
     +
     +RSAAuthentication yes
     +PubkeyAuthentication yes
     +#AuthorizedKeysFile	%h/.ssh/authorized_keys
     +
     +# Don't read the user's ~/.rhosts and ~/.shosts files
     +IgnoreRhosts yes
     +# For this to work you will also need host keys in /etc/ssh_known_hosts
     +RhostsRSAAuthentication no
     +# similar for protocol version 2
     +HostbasedAuthentication no
     +# Uncomment if you don't trust ~/.ssh/known_hosts for RhostsRSAAuthentication
     +#IgnoreUserKnownHosts yes
     +
     +# To enable empty passwords, change to yes (NOT RECOMMENDED)
     +PermitEmptyPasswords no
     +
     +# Change to yes to enable challenge-response passwords (beware issues with
     +# some PAM modules and threads)
     +ChallengeResponseAuthentication no
     +
     +# Change to no to disable tunnelled clear text passwords
     +PasswordAuthentication no
     +
     +# Kerberos options
     +#KerberosAuthentication no
     +#KerberosGetAFSToken no
     +#KerberosOrLocalPasswd yes
     +#KerberosTicketCleanup yes
     +
     +# GSSAPI options
     +#GSSAPIAuthentication no
     +#GSSAPICleanupCredentials yes
     +
     +X11Forwarding yes
     +X11DisplayOffset 10
     +PrintMotd no
     +PrintLastLog yes
     +TCPKeepAlive yes
     +#UseLogin no
     +
     +#MaxStartups 10:30:60
     +#Banner /etc/issue.net
     +
     +# Allow client to pass locale environment variables
     +AcceptEnv LANG LC_*
     +
     +Subsystem sftp /usr/lib/openssh/sftp-server
     +
     +# Set this to 'yes' to enable PAM authentication, account processing,
     +# and session processing. If this is enabled, PAM authentication will
     +# be allowed through the ChallengeResponseAuthentication and
     +# PasswordAuthentication.  Depending on your PAM configuration,
     +# PAM authentication via ChallengeResponseAuthentication may bypass
     +# the setting of "PermitRootLogin without-password".
     +# If you just want the PAM account and session checks to run without
     +# PAM authentication, then enable this but set PasswordAuthentication
     +# and ChallengeResponseAuthentication to 'no'.
     +UsePAM yes
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.3.14_Set_SSH_Banner:  should match /issue(\.net)?/expected nil to match /issue(\.net)?/[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_9.5_Restrict_Access_to_the_su_Command: File /etc/pam.d/su content should match /^\s*auth\s+required\s+pam_wheel.so\s+use_uid/expected "#\n# The PAM configuration file for the Shadow `su' service\n#\n\n# This allows root to su without passwords (normal operation)\nauth       sufficient pam_rootok.so\n\n# Uncomment this to force users to be a member of group root\n# before they can use `su'. You can also add \"group=foo\"\n# to the end of this line if you want to use a group other\n# than the default \"root\" (but this may have side effect of\n# denying \"root\" user, unless she's a member of \"foo\" or explicitly\n# permitted earlier by e.g. \"sufficient pam_rootok.so\").\n# (Replaces the `SU_WHEEL_ONLY' option from login.defs)\n# auth       required   pam_wheel.so\n\n# Uncomment this if you want wheel members to be able to\n# su without a password.\n# auth       sufficient pam_wheel.so trust\n\n# Uncomment this if you want members of a specific group to not\n# be allowed to use su at all.\n# auth       required   pam_wheel.so deny group=nosu\n\n# Uncomment and edit /etc/security/time.conf if you need to set\n# time restrainst on su usage.\n# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs\n# as well as /etc/porttime)\n# account    requisite  pam_time.so\n\n# This module parses environment configuration file(s)\n# and also allows you to use an extended config\n# file /etc/security/pam_env.conf.\n# \n# parsing /etc/environment needs \"readenv=1\"\nsession       required   pam_env.so readenv=1\n# locale variables are also kept into /etc/default/locale in etch\n# reading this file *in addition to /etc/environment* does not hurt\nsession       required   pam_env.so readenv=1 envfile=/etc/default/locale\n\n# Defines the MAIL environment variable\n# However, userdel also needs MAIL_DIR and MAIL_FILE variables\n# in /etc/login.defs to make sure that removing a user \n# also removes the user's mail spool file.\n# See comments in /etc/login.defs\n#\n# \"nopen\" stands to avoid reporting new mail when su'ing to another user\nsession    optional   pam_mail.so nopen\n\n# Sets up user limits, please uncomment and read /etc/security/limits.conf\n# to enable this functionality.\n# (Replaces the use of /etc/limits in old login)\n# session    required   pam_limits.so\n\n# The standard Unix authentication modules, used with\n# NIS (man nsswitch) as well as normal /etc/passwd and\n# /etc/shadow entries.\n@include common-auth\n@include common-account\n@include common-session\n\n\n" to match /^\s*auth\s+required\s+pam_wheel.so\s+use_uid/
     Diff:
     @@ -1,2 +1,61 @@
     -/^\s*auth\s+required\s+pam_wheel.so\s+use_uid/
     +#
     +# The PAM configuration file for the Shadow `su' service
     +#
     +
     +# This allows root to su without passwords (normal operation)
     +auth       sufficient pam_rootok.so
     +
     +# Uncomment this to force users to be a member of group root
     +# before they can use `su'. You can also add "group=foo"
     +# to the end of this line if you want to use a group other
     +# than the default "root" (but this may have side effect of
     +# denying "root" user, unless she's a member of "foo" or explicitly
     +# permitted earlier by e.g. "sufficient pam_rootok.so").
     +# (Replaces the `SU_WHEEL_ONLY' option from login.defs)
     +# auth       required   pam_wheel.so
     +
     +# Uncomment this if you want wheel members to be able to
     +# su without a password.
     +# auth       sufficient pam_wheel.so trust
     +
     +# Uncomment this if you want members of a specific group to not
     +# be allowed to use su at all.
     +# auth       required   pam_wheel.so deny group=nosu
     +
     +# Uncomment and edit /etc/security/time.conf if you need to set
     +# time restrainst on su usage.
     +# (Replaces the `PORTTIME_CHECKS_ENAB' option from login.defs
     +# as well as /etc/porttime)
     +# account    requisite  pam_time.so
     +
     +# This module parses environment configuration file(s)
     +# and also allows you to use an extended config
     +# file /etc/security/pam_env.conf.
     +# 
     +# parsing /etc/environment needs "readenv=1"
     +session       required   pam_env.so readenv=1
     +# locale variables are also kept into /etc/default/locale in etch
     +# reading this file *in addition to /etc/environment* does not hurt
     +session       required   pam_env.so readenv=1 envfile=/etc/default/locale
     +
     +# Defines the MAIL environment variable
     +# However, userdel also needs MAIL_DIR and MAIL_FILE variables
     +# in /etc/login.defs to make sure that removing a user 
     +# also removes the user's mail spool file.
     +# See comments in /etc/login.defs
     +#
     +# "nopen" stands to avoid reporting new mail when su'ing to another user
     +session    optional   pam_mail.so nopen
     +
     +# Sets up user limits, please uncomment and read /etc/security/limits.conf
     +# to enable this functionality.
     +# (Replaces the use of /etc/limits in old login)
     +# session    required   pam_limits.so
     +
     +# The standard Unix authentication modules, used with
     +# NIS (man nsswitch) as well as normal /etc/passwd and
     +# /etc/shadow entries.
     +@include common-auth
     +@include common-account
     +@include common-session
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_10.1.1_Set_Password_Expiration_Days: File /etc/login.defs content should match /^\s*PASS_MAX_DAYS\s+90/expected "#\n# /etc/login.defs - Configuration control definitions for the login package.\n#\n# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n# If unspecified, some arbitrary (and possibly incorrect) value will\n# be assumed.  All other items are optional - if not specified then\n# the described action or option will be inhibited.\n#\n# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n#\n# Modified for Linux.  --marekm\n\n# REQUIRED for useradd/userdel/usermod\n#   Directory where mailboxes reside, _or_ name of file, relative to the\n#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n#   MAIL_DIR takes precedence.\n#\n#   Essentially:\n#      - MAIL_DIR defines the location of users mail spool files\n#        (for mbox use) by appending the username to MAIL_DIR as defined\n#        below.\n#      - MAIL_FILE defines the location of the users mail spool files as the\n#        fully-qualified filename obtained by prepending the user home\n#        directory before $MAIL_FILE\n#\n# NOTE: This is no more used for setting up users MAIL environment variable\n#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n#       job of the pam_mail PAM modules\n#       See default PAM configuration files provided for\n#       login, su, etc.\n#\n# This is a temporary situation: setting these variables will soon\n# move to /etc/default/useradd and the variables will then be\n# no more supported\nMAIL_DIR        /var/mail\n#MAIL_FILE      .mail\n\n#\n# Enable logging and display of /var/log/faillog login failure info.\n# This option conflicts with the pam_tally PAM module.\n#\nFAILLOG_ENAB\t\tyes\n\n#\n# Enable display of unknown usernames when login failures are recorded.\n#\n# WARNING: Unknown usernames may become world readable. \n# See #290803 and #298773 for details about how this could become a security\n# concern\nLOG_UNKFAIL_ENAB\tno\n\n#\n# Enable logging of successful logins\n#\nLOG_OK_LOGINS\t\tno\n\n#\n# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n# SYSLOG_SG_ENAB does the same for newgrp and sg.\n#\nSYSLOG_SU_ENAB\t\tyes\nSYSLOG_SG_ENAB\t\tyes\n\n#\n# If defined, all su activity is logged to this file.\n#\n#SULOG_FILE\t/var/log/sulog\n\n#\n# If defined, file which maps tty line to TERM environment parameter.\n# Each line of the file is in a format something like \"vt100  tty01\".\n#\n#TTYTYPE_FILE\t/etc/ttytype\n\n#\n# If defined, login failures will be logged here in a utmp format\n# last, when invoked as lastb, will read /var/log/btmp, so...\n#\nFTMP_FILE\t/var/log/btmp\n\n#\n# If defined, the command name to display when running \"su -\".  For\n# example, if this is defined as \"su\" then a \"ps\" will display the\n# command is \"-su\".  If not defined, then \"ps\" would display the\n# name of the shell actually being run, e.g. something like \"-sh\".\n#\nSU_NAME\t\tsu\n\n#\n# If defined, file which inhibits all the usual chatter during the login\n# sequence.  If a full pathname, then hushed mode will be enabled if the\n# user's name or shell are found in the file.  If not a full pathname, then\n# hushed mode will be enabled if the file exists in the user's home directory.\n#\nHUSHLOGIN_FILE\t.hushlogin\n#HUSHLOGIN_FILE\t/etc/hushlogins\n\n#\n# *REQUIRED*  The default PATH settings, for superuser and normal users.\n#\n# (they are minimal, add the rest in the shell startup files)\nENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n\n#\n# Terminal permissions\n#\n#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n#\tTTYPERM\t\tLogin tty will be set to this permission.\n#\n# If you have a \"write\" program which is \"setgid\" to a special group\n# which owns the terminals, define TTYGROUP to the group number and\n# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n# TTYPERM to either 622 or 600.\n#\n# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n# However, the default and recommended value for TTYPERM is still 0600\n# to not allow anyone to write to anyone else console or terminal\n\n# Users can still allow other people to write them by issuing \n# the \"mesg y\" command.\n\nTTYGROUP\ttty\nTTYPERM\t\t0600\n\n#\n# Login configuration initializations:\n#\n#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n#\tUMASK\t\tDefault \"umask\" value.\n#\n# The ERASECHAR and KILLCHAR are used only on System V machines.\n# \n# UMASK is the default umask value for pam_umask and is used by\n# useradd and newusers to set the mode of the new home directories.\n# 022 is the \"historical\" value in Debian for UMASK\n# 027, or even 077, could be considered better for privacy\n# There is no One True Answer here : each sysadmin must make up his/her\n# mind.\n#\n# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n# for private user groups, i. e. the uid is the same as gid, and username is\n# the same as the primary group name: for these, the user permissions will be\n# used as group permissions, e. g. 022 will become 002.\n#\n# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n#\nERASECHAR\t0177\nKILLCHAR\t025\nUMASK\t\t022\n\n#\n# Password aging controls:\n#\n#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n#\nPASS_MAX_DAYS\t99999\nPASS_MIN_DAYS\t0\nPASS_WARN_AGE\t7\n\n#\n# Min/max values for automatic uid selection in useradd\n#\nUID_MIN\t\t\t 1000\nUID_MAX\t\t\t60000\n# System accounts\n#SYS_UID_MIN\t\t  100\n#SYS_UID_MAX\t\t  999\n\n#\n# Min/max values for automatic gid selection in groupadd\n#\nGID_MIN\t\t\t 1000\nGID_MAX\t\t\t60000\n# System accounts\n#SYS_GID_MIN\t\t  100\n#SYS_GID_MAX\t\t  999\n\n#\n# Max number of login retries if password is bad. This will most likely be\n# overriden by PAM, since the default pam_unix module has it's own built\n# in of 3 retries. However, this is a safe fallback in case you are using\n# an authentication module that does not enforce PAM_MAXTRIES.\n#\nLOGIN_RETRIES\t\t5\n\n#\n# Max time in seconds for login\n#\nLOGIN_TIMEOUT\t\t60\n\n#\n# Which fields may be changed by regular users using chfn - use\n# any combination of letters \"frwh\" (full name, room number, work\n# phone, home phone).  If not defined, no changes are allowed.\n# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n# \nCHFN_RESTRICT\t\trwh\n\n#\n# Should login be allowed if we can't cd to the home directory?\n# Default in no.\n#\nDEFAULT_HOME\tyes\n\n#\n# If defined, this command is run when removing a user.\n# It should remove any at/cron/print jobs etc. owned by\n# the user to be removed (passed as the first argument).\n#\n#USERDEL_CMD\t/usr/sbin/userdel_local\n\n#\n# Enable setting of the umask group bits to be the same as owner bits\n# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n# the same as gid, and username is the same as the primary group name.\n#\n# If set to yes, userdel will remove the userÂ´s group if it contains no\n# more members, and useradd will create by default a group with the name\n# of the user.\n#\nUSERGROUPS_ENAB yes\n\n#\n# Instead of the real user shell, the program specified by this parameter\n# will be launched, although its visible name (argv[0]) will be the shell's.\n# The program may do whatever it wants (logging, additional authentification,\n# banner, ...) before running the actual shell.\n#\n# FAKE_SHELL /bin/fakeshell\n\n#\n# If defined, either full pathname of a file containing device names or\n# a \":\" delimited list of device names.  Root logins will be allowed only\n# upon these devices.\n#\n# This variable is used by login and su.\n#\n#CONSOLE\t/etc/consoles\n#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n\n#\n# List of groups to add to the user's supplementary group set\n# when logging in on the console (as determined by the CONSOLE\n# setting).  Default is none.\n#\n# Use with caution - it is possible for users to gain permanent\n# access to these groups, even when not logged in on the console.\n# How to do it is left as an exercise for the reader...\n#\n# This variable is used by login and su.\n#\n#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n\n#\n# If set to \"yes\", new passwords will be encrypted using the MD5-based\n# algorithm compatible with the one used by recent releases of FreeBSD.\n# It supports passwords of unlimited length and longer salt strings.\n# Set to \"no\" if you need to copy encrypted passwords to other systems\n# which don't understand the new algorithm.  Default is \"no\".\n#\n# This variable is deprecated. You should use ENCRYPT_METHOD.\n#\n#MD5_CRYPT_ENAB\tno\n\n#\n# If set to MD5 , MD5-based algorithm will be used for encrypting password\n# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n# If set to DES, DES-based algorithm will be used for encrypting password (default)\n# Overrides the MD5_CRYPT_ENAB option\n#\n# Note: It is recommended to use a value consistent with\n# the PAM modules configuration.\n#\nENCRYPT_METHOD SHA512\n\n#\n# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n#\n# Define the number of SHA rounds.\n# With a lot of rounds, it is more difficult to brute forcing the password.\n# But note also that it more CPU resources will be needed to authenticate\n# users.\n#\n# If not specified, the libc will choose the default number of rounds (5000).\n# The values must be inside the 1000-999999999 range.\n# If only one of the MIN or MAX values is set, then this value will be used.\n# If MIN > MAX, the highest value will be used.\n#\n# SHA_CRYPT_MIN_ROUNDS 5000\n# SHA_CRYPT_MAX_ROUNDS 5000\n\n################# OBSOLETED BY PAM ##############\n#\t\t\t\t\t\t#\n# These options are now handled by PAM. Please\t#\n# edit the appropriate file in /etc/pam.d/ to\t#\n# enable the equivelants of them.\n#\n###############\n\n#MOTD_FILE\n#DIALUPS_CHECK_ENAB\n#LASTLOG_ENAB\n#MAIL_CHECK_ENAB\n#OBSCURE_CHECKS_ENAB\n#PORTTIME_CHECKS_ENAB\n#SU_WHEEL_ONLY\n#CRACKLIB_DICTPATH\n#PASS_CHANGE_TRIES\n#PASS_ALWAYS_WARN\n#ENVIRON_FILE\n#NOLOGINS_FILE\n#ISSUE_FILE\n#PASS_MIN_LEN\n#PASS_MAX_LEN\n#ULIMIT\n#ENV_HZ\n#CHFN_AUTH\n#CHSH_AUTH\n#FAIL_DELAY\n\n################# OBSOLETED #######################\n#\t\t\t\t\t\t  #\n# These options are no more handled by shadow.    #\n#                                                 #\n# Shadow utilities will display a warning if they #\n# still appear.                                   #\n#                                                 #\n###################################################\n\n# CLOSE_SESSIONS\n# LOGIN_STRING\n# NO_PASSWORD_CONSOLE\n# QMAIL_DIR\n\n\n\n" to match /^\s*PASS_MAX_DAYS\s+90/
     Diff:
     @@ -1,2 +1,339 @@
     -/^\s*PASS_MAX_DAYS\s+90/
     +#
     +# /etc/login.defs - Configuration control definitions for the login package.
     +#
     +# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.
     +# If unspecified, some arbitrary (and possibly incorrect) value will
     +# be assumed.  All other items are optional - if not specified then
     +# the described action or option will be inhibited.
     +#
     +# Comment lines (lines beginning with "#") and blank lines are ignored.
     +#
     +# Modified for Linux.  --marekm
     +
     +# REQUIRED for useradd/userdel/usermod
     +#   Directory where mailboxes reside, _or_ name of file, relative to the
     +#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,
     +#   MAIL_DIR takes precedence.
     +#
     +#   Essentially:
     +#      - MAIL_DIR defines the location of users mail spool files
     +#        (for mbox use) by appending the username to MAIL_DIR as defined
     +#        below.
     +#      - MAIL_FILE defines the location of the users mail spool files as the
     +#        fully-qualified filename obtained by prepending the user home
     +#        directory before $MAIL_FILE
     +#
     +# NOTE: This is no more used for setting up users MAIL environment variable
     +#       which is, starting from shadow 4.0.12-1 in Debian, entirely the
     +#       job of the pam_mail PAM modules
     +#       See default PAM configuration files provided for
     +#       login, su, etc.
     +#
     +# This is a temporary situation: setting these variables will soon
     +# move to /etc/default/useradd and the variables will then be
     +# no more supported
     +MAIL_DIR        /var/mail
     +#MAIL_FILE      .mail
     +
     +#
     +# Enable logging and display of /var/log/faillog login failure info.
     +# This option conflicts with the pam_tally PAM module.
     +#
     +FAILLOG_ENAB		yes
     +
     +#
     +# Enable display of unknown usernames when login failures are recorded.
     +#
     +# WARNING: Unknown usernames may become world readable. 
     +# See #290803 and #298773 for details about how this could become a security
     +# concern
     +LOG_UNKFAIL_ENAB	no
     +
     +#
     +# Enable logging of successful logins
     +#
     +LOG_OK_LOGINS		no
     +
     +#
     +# Enable "syslog" logging of su activity - in addition to sulog file logging.
     +# SYSLOG_SG_ENAB does the same for newgrp and sg.
     +#
     +SYSLOG_SU_ENAB		yes
     +SYSLOG_SG_ENAB		yes
     +
     +#
     +# If defined, all su activity is logged to this file.
     +#
     +#SULOG_FILE	/var/log/sulog
     +
     +#
     +# If defined, file which maps tty line to TERM environment parameter.
     +# Each line of the file is in a format something like "vt100  tty01".
     +#
     +#TTYTYPE_FILE	/etc/ttytype
     +
     +#
     +# If defined, login failures will be logged here in a utmp format
     +# last, when invoked as lastb, will read /var/log/btmp, so...
     +#
     +FTMP_FILE	/var/log/btmp
     +
     +#
     +# If defined, the command name to display when running "su -".  For
     +# example, if this is defined as "su" then a "ps" will display the
     +# command is "-su".  If not defined, then "ps" would display the
     +# name of the shell actually being run, e.g. something like "-sh".
     +#
     +SU_NAME		su
     +
     +#
     +# If defined, file which inhibits all the usual chatter during the login
     +# sequence.  If a full pathname, then hushed mode will be enabled if the
     +# user's name or shell are found in the file.  If not a full pathname, then
     +# hushed mode will be enabled if the file exists in the user's home directory.
     +#
     +HUSHLOGIN_FILE	.hushlogin
     +#HUSHLOGIN_FILE	/etc/hushlogins
     +
     +#
     +# *REQUIRED*  The default PATH settings, for superuser and normal users.
     +#
     +# (they are minimal, add the rest in the shell startup files)
     +ENV_SUPATH	PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
     +ENV_PATH	PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
     +
     +#
     +# Terminal permissions
     +#
     +#	TTYGROUP	Login tty will be assigned this group ownership.
     +#	TTYPERM		Login tty will be set to this permission.
     +#
     +# If you have a "write" program which is "setgid" to a special group
     +# which owns the terminals, define TTYGROUP to the group number and
     +# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign
     +# TTYPERM to either 622 or 600.
     +#
     +# In Debian /usr/bin/bsd-write or similar programs are setgid tty
     +# However, the default and recommended value for TTYPERM is still 0600
     +# to not allow anyone to write to anyone else console or terminal
     +
     +# Users can still allow other people to write them by issuing 
     +# the "mesg y" command.
     +
     +TTYGROUP	tty
     +TTYPERM		0600
     +
     +#
     +# Login configuration initializations:
     +#
     +#	ERASECHAR	Terminal ERASE character ('\010' = backspace).
     +#	KILLCHAR	Terminal KILL character ('\025' = CTRL/U).
     +#	UMASK		Default "umask" value.
     +#
     +# The ERASECHAR and KILLCHAR are used only on System V machines.
     +# 
     +# UMASK is the default umask value for pam_umask and is used by
     +# useradd and newusers to set the mode of the new home directories.
     +# 022 is the "historical" value in Debian for UMASK
     +# 027, or even 077, could be considered better for privacy
     +# There is no One True Answer here : each sysadmin must make up his/her
     +# mind.
     +#
     +# If USERGROUPS_ENAB is set to "yes", that will modify this UMASK default value
     +# for private user groups, i. e. the uid is the same as gid, and username is
     +# the same as the primary group name: for these, the user permissions will be
     +# used as group permissions, e. g. 022 will become 002.
     +#
     +# Prefix these values with "0" to get octal, "0x" to get hexadecimal.
     +#
     +ERASECHAR	0177
     +KILLCHAR	025
     +UMASK		022
     +
     +#
     +# Password aging controls:
     +#
     +#	PASS_MAX_DAYS	Maximum number of days a password may be used.
     +#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
     +#	PASS_WARN_AGE	Number of days warning given before a password expires.
     +#
     +PASS_MAX_DAYS	99999
     +PASS_MIN_DAYS	0
     +PASS_WARN_AGE	7
     +
     +#
     +# Min/max values for automatic uid selection in useradd
     +#
     +UID_MIN			 1000
     +UID_MAX			60000
     +# System accounts
     +#SYS_UID_MIN		  100
     +#SYS_UID_MAX		  999
     +
     +#
     +# Min/max values for automatic gid selection in groupadd
     +#
     +GID_MIN			 1000
     +GID_MAX			60000
     +# System accounts
     +#SYS_GID_MIN		  100
     +#SYS_GID_MAX		  999
     +
     +#
     +# Max number of login retries if password is bad. This will most likely be
     +# overriden by PAM, since the default pam_unix module has it's own built
     +# in of 3 retries. However, this is a safe fallback in case you are using
     +# an authentication module that does not enforce PAM_MAXTRIES.
     +#
     +LOGIN_RETRIES		5
     +
     +#
     +# Max time in seconds for login
     +#
     +LOGIN_TIMEOUT		60
     +
     +#
     +# Which fields may be changed by regular users using chfn - use
     +# any combination of letters "frwh" (full name, room number, work
     +# phone, home phone).  If not defined, no changes are allowed.
     +# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
     +# 
     +CHFN_RESTRICT		rwh
     +
     +#
     +# Should login be allowed if we can't cd to the home directory?
     +# Default in no.
     +#
     +DEFAULT_HOME	yes
     +
     +#
     +# If defined, this command is run when removing a user.
     +# It should remove any at/cron/print jobs etc. owned by
     +# the user to be removed (passed as the first argument).
     +#
     +#USERDEL_CMD	/usr/sbin/userdel_local
     +
     +#
     +# Enable setting of the umask group bits to be the same as owner bits
     +# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is
     +# the same as gid, and username is the same as the primary group name.
     +#
     +# If set to yes, userdel will remove the userÂ´s group if it contains no
     +# more members, and useradd will create by default a group with the name
     +# of the user.
     +#
     +USERGROUPS_ENAB yes
     +
     +#
     +# Instead of the real user shell, the program specified by this parameter
     +# will be launched, although its visible name (argv[0]) will be the shell's.
     +# The program may do whatever it wants (logging, additional authentification,
     +# banner, ...) before running the actual shell.
     +#
     +# FAKE_SHELL /bin/fakeshell
     +
     +#
     +# If defined, either full pathname of a file containing device names or
     +# a ":" delimited list of device names.  Root logins will be allowed only
     +# upon these devices.
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE	/etc/consoles
     +#CONSOLE	console:tty01:tty02:tty03:tty04
     +
     +#
     +# List of groups to add to the user's supplementary group set
     +# when logging in on the console (as determined by the CONSOLE
     +# setting).  Default is none.
     +#
     +# Use with caution - it is possible for users to gain permanent
     +# access to these groups, even when not logged in on the console.
     +# How to do it is left as an exercise for the reader...
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE_GROUPS		floppy:audio:cdrom
     +
     +#
     +# If set to "yes", new passwords will be encrypted using the MD5-based
     +# algorithm compatible with the one used by recent releases of FreeBSD.
     +# It supports passwords of unlimited length and longer salt strings.
     +# Set to "no" if you need to copy encrypted passwords to other systems
     +# which don't understand the new algorithm.  Default is "no".
     +#
     +# This variable is deprecated. You should use ENCRYPT_METHOD.
     +#
     +#MD5_CRYPT_ENAB	no
     +
     +#
     +# If set to MD5 , MD5-based algorithm will be used for encrypting password
     +# If set to SHA256, SHA256-based algorithm will be used for encrypting password
     +# If set to SHA512, SHA512-based algorithm will be used for encrypting password
     +# If set to DES, DES-based algorithm will be used for encrypting password (default)
     +# Overrides the MD5_CRYPT_ENAB option
     +#
     +# Note: It is recommended to use a value consistent with
     +# the PAM modules configuration.
     +#
     +ENCRYPT_METHOD SHA512
     +
     +#
     +# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.
     +#
     +# Define the number of SHA rounds.
     +# With a lot of rounds, it is more difficult to brute forcing the password.
     +# But note also that it more CPU resources will be needed to authenticate
     +# users.
     +#
     +# If not specified, the libc will choose the default number of rounds (5000).
     +# The values must be inside the 1000-999999999 range.
     +# If only one of the MIN or MAX values is set, then this value will be used.
     +# If MIN > MAX, the highest value will be used.
     +#
     +# SHA_CRYPT_MIN_ROUNDS 5000
     +# SHA_CRYPT_MAX_ROUNDS 5000
     +
     +################# OBSOLETED BY PAM ##############
     +#						#
     +# These options are now handled by PAM. Please	#
     +# edit the appropriate file in /etc/pam.d/ to	#
     +# enable the equivelants of them.
     +#
     +###############
     +
     +#MOTD_FILE
     +#DIALUPS_CHECK_ENAB
     +#LASTLOG_ENAB
     +#MAIL_CHECK_ENAB
     +#OBSCURE_CHECKS_ENAB
     +#PORTTIME_CHECKS_ENAB
     +#SU_WHEEL_ONLY
     +#CRACKLIB_DICTPATH
     +#PASS_CHANGE_TRIES
     +#PASS_ALWAYS_WARN
     +#ENVIRON_FILE
     +#NOLOGINS_FILE
     +#ISSUE_FILE
     +#PASS_MIN_LEN
     +#PASS_MAX_LEN
     +#ULIMIT
     +#ENV_HZ
     +#CHFN_AUTH
     +#CHSH_AUTH
     +#FAIL_DELAY
     +
     +################# OBSOLETED #######################
     +#						  #
     +# These options are no more handled by shadow.    #
     +#                                                 #
     +# Shadow utilities will display a warning if they #
     +# still appear.                                   #
     +#                                                 #
     +###################################################
     +
     +# CLOSE_SESSIONS
     +# LOGIN_STRING
     +# NO_PASSWORD_CONSOLE
     +# QMAIL_DIR
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_10.1.2_Set_Password_Change_Minimum_Number_of_Days: File /etc/login.defs content should match /^\s*PASS_MIN_DAYS\s+([7-9]|[1-9][0-9]*)/expected "#\n# /etc/login.defs - Configuration control definitions for the login package.\n#\n# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n# If unspecified, some arbitrary (and possibly incorrect) value will\n# be assumed.  All other items are optional - if not specified then\n# the described action or option will be inhibited.\n#\n# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n#\n# Modified for Linux.  --marekm\n\n# REQUIRED for useradd/userdel/usermod\n#   Directory where mailboxes reside, _or_ name of file, relative to the\n#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n#   MAIL_DIR takes precedence.\n#\n#   Essentially:\n#      - MAIL_DIR defines the location of users mail spool files\n#        (for mbox use) by appending the username to MAIL_DIR as defined\n#        below.\n#      - MAIL_FILE defines the location of the users mail spool files as the\n#        fully-qualified filename obtained by prepending the user home\n#        directory before $MAIL_FILE\n#\n# NOTE: This is no more used for setting up users MAIL environment variable\n#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n#       job of the pam_mail PAM modules\n#       See default PAM configuration files provided for\n#       login, su, etc.\n#\n# This is a temporary situation: setting these variables will soon\n# move to /etc/default/useradd and the variables will then be\n# no more supported\nMAIL_DIR        /var/mail\n#MAIL_FILE      .mail\n\n#\n# Enable logging and display of /var/log/faillog login failure info.\n# This option conflicts with the pam_tally PAM module.\n#\nFAILLOG_ENAB\t\tyes\n\n#\n# Enable display of unknown usernames when login failures are recorded.\n#\n# WARNING: Unknown usernames may become world readable. \n# See #290803 and #298773 for details about how this could become a security\n# concern\nLOG_UNKFAIL_ENAB\tno\n\n#\n# Enable logging of successful logins\n#\nLOG_OK_LOGINS\t\tno\n\n#\n# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n# SYSLOG_SG_ENAB does the same for newgrp and sg.\n#\nSYSLOG_SU_ENAB\t\tyes\nSYSLOG_SG_ENAB\t\tyes\n\n#\n# If defined, all su activity is logged to this file.\n#\n#SULOG_FILE\t/var/log/sulog\n\n#\n# If defined, file which maps tty line to TERM environment parameter.\n# Each line of the file is in a format something like \"vt100  tty01\".\n#\n#TTYTYPE_FILE\t/etc/ttytype\n\n#\n# If defined, login failures will be logged here in a utmp format\n# last, when invoked as lastb, will read /var/log/btmp, so...\n#\nFTMP_FILE\t/var/log/btmp\n\n#\n# If defined, the command name to display when running \"su -\".  For\n# example, if this is defined as \"su\" then a \"ps\" will display the\n# command is \"-su\".  If not defined, then \"ps\" would display the\n# name of the shell actually being run, e.g. something like \"-sh\".\n#\nSU_NAME\t\tsu\n\n#\n# If defined, file which inhibits all the usual chatter during the login\n# sequence.  If a full pathname, then hushed mode will be enabled if the\n# user's name or shell are found in the file.  If not a full pathname, then\n# hushed mode will be enabled if the file exists in the user's home directory.\n#\nHUSHLOGIN_FILE\t.hushlogin\n#HUSHLOGIN_FILE\t/etc/hushlogins\n\n#\n# *REQUIRED*  The default PATH settings, for superuser and normal users.\n#\n# (they are minimal, add the rest in the shell startup files)\nENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n\n#\n# Terminal permissions\n#\n#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n#\tTTYPERM\t\tLogin tty will be set to this permission.\n#\n# If you have a \"write\" program which is \"setgid\" to a special group\n# which owns the terminals, define TTYGROUP to the group number and\n# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n# TTYPERM to either 622 or 600.\n#\n# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n# However, the default and recommended value for TTYPERM is still 0600\n# to not allow anyone to write to anyone else console or terminal\n\n# Users can still allow other people to write them by issuing \n# the \"mesg y\" command.\n\nTTYGROUP\ttty\nTTYPERM\t\t0600\n\n#\n# Login configuration initializations:\n#\n#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n#\tUMASK\t\tDefault \"umask\" value.\n#\n# The ERASECHAR and KILLCHAR are used only on System V machines.\n# \n# UMASK is the default umask value for pam_umask and is used by\n# useradd and newusers to set the mode of the new home directories.\n# 022 is the \"historical\" value in Debian for UMASK\n# 027, or even 077, could be considered better for privacy\n# There is no One True Answer here : each sysadmin must make up his/her\n# mind.\n#\n# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n# for private user groups, i. e. the uid is the same as gid, and username is\n# the same as the primary group name: for these, the user permissions will be\n# used as group permissions, e. g. 022 will become 002.\n#\n# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n#\nERASECHAR\t0177\nKILLCHAR\t025\nUMASK\t\t022\n\n#\n# Password aging controls:\n#\n#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n#\nPASS_MAX_DAYS\t99999\nPASS_MIN_DAYS\t0\nPASS_WARN_AGE\t7\n\n#\n# Min/max values for automatic uid selection in useradd\n#\nUID_MIN\t\t\t 1000\nUID_MAX\t\t\t60000\n# System accounts\n#SYS_UID_MIN\t\t  100\n#SYS_UID_MAX\t\t  999\n\n#\n# Min/max values for automatic gid selection in groupadd\n#\nGID_MIN\t\t\t 1000\nGID_MAX\t\t\t60000\n# System accounts\n#SYS_GID_MIN\t\t  100\n#SYS_GID_MAX\t\t  999\n\n#\n# Max number of login retries if password is bad. This will most likely be\n# overriden by PAM, since the default pam_unix module has it's own built\n# in of 3 retries. However, this is a safe fallback in case you are using\n# an authentication module that does not enforce PAM_MAXTRIES.\n#\nLOGIN_RETRIES\t\t5\n\n#\n# Max time in seconds for login\n#\nLOGIN_TIMEOUT\t\t60\n\n#\n# Which fields may be changed by regular users using chfn - use\n# any combination of letters \"frwh\" (full name, room number, work\n# phone, home phone).  If not defined, no changes are allowed.\n# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n# \nCHFN_RESTRICT\t\trwh\n\n#\n# Should login be allowed if we can't cd to the home directory?\n# Default in no.\n#\nDEFAULT_HOME\tyes\n\n#\n# If defined, this command is run when removing a user.\n# It should remove any at/cron/print jobs etc. owned by\n# the user to be removed (passed as the first argument).\n#\n#USERDEL_CMD\t/usr/sbin/userdel_local\n\n#\n# Enable setting of the umask group bits to be the same as owner bits\n# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n# the same as gid, and username is the same as the primary group name.\n#\n# If set to yes, userdel will remove the userÂ´s group if it contains no\n# more members, and useradd will create by default a group with the name\n# of the user.\n#\nUSERGROUPS_ENAB yes\n\n#\n# Instead of the real user shell, the program specified by this parameter\n# will be launched, although its visible name (argv[0]) will be the shell's.\n# The program may do whatever it wants (logging, additional authentification,\n# banner, ...) before running the actual shell.\n#\n# FAKE_SHELL /bin/fakeshell\n\n#\n# If defined, either full pathname of a file containing device names or\n# a \":\" delimited list of device names.  Root logins will be allowed only\n# upon these devices.\n#\n# This variable is used by login and su.\n#\n#CONSOLE\t/etc/consoles\n#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n\n#\n# List of groups to add to the user's supplementary group set\n# when logging in on the console (as determined by the CONSOLE\n# setting).  Default is none.\n#\n# Use with caution - it is possible for users to gain permanent\n# access to these groups, even when not logged in on the console.\n# How to do it is left as an exercise for the reader...\n#\n# This variable is used by login and su.\n#\n#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n\n#\n# If set to \"yes\", new passwords will be encrypted using the MD5-based\n# algorithm compatible with the one used by recent releases of FreeBSD.\n# It supports passwords of unlimited length and longer salt strings.\n# Set to \"no\" if you need to copy encrypted passwords to other systems\n# which don't understand the new algorithm.  Default is \"no\".\n#\n# This variable is deprecated. You should use ENCRYPT_METHOD.\n#\n#MD5_CRYPT_ENAB\tno\n\n#\n# If set to MD5 , MD5-based algorithm will be used for encrypting password\n# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n# If set to DES, DES-based algorithm will be used for encrypting password (default)\n# Overrides the MD5_CRYPT_ENAB option\n#\n# Note: It is recommended to use a value consistent with\n# the PAM modules configuration.\n#\nENCRYPT_METHOD SHA512\n\n#\n# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n#\n# Define the number of SHA rounds.\n# With a lot of rounds, it is more difficult to brute forcing the password.\n# But note also that it more CPU resources will be needed to authenticate\n# users.\n#\n# If not specified, the libc will choose the default number of rounds (5000).\n# The values must be inside the 1000-999999999 range.\n# If only one of the MIN or MAX values is set, then this value will be used.\n# If MIN > MAX, the highest value will be used.\n#\n# SHA_CRYPT_MIN_ROUNDS 5000\n# SHA_CRYPT_MAX_ROUNDS 5000\n\n################# OBSOLETED BY PAM ##############\n#\t\t\t\t\t\t#\n# These options are now handled by PAM. Please\t#\n# edit the appropriate file in /etc/pam.d/ to\t#\n# enable the equivelants of them.\n#\n###############\n\n#MOTD_FILE\n#DIALUPS_CHECK_ENAB\n#LASTLOG_ENAB\n#MAIL_CHECK_ENAB\n#OBSCURE_CHECKS_ENAB\n#PORTTIME_CHECKS_ENAB\n#SU_WHEEL_ONLY\n#CRACKLIB_DICTPATH\n#PASS_CHANGE_TRIES\n#PASS_ALWAYS_WARN\n#ENVIRON_FILE\n#NOLOGINS_FILE\n#ISSUE_FILE\n#PASS_MIN_LEN\n#PASS_MAX_LEN\n#ULIMIT\n#ENV_HZ\n#CHFN_AUTH\n#CHSH_AUTH\n#FAIL_DELAY\n\n################# OBSOLETED #######################\n#\t\t\t\t\t\t  #\n# These options are no more handled by shadow.    #\n#                                                 #\n# Shadow utilities will display a warning if they #\n# still appear.                                   #\n#                                                 #\n###################################################\n\n# CLOSE_SESSIONS\n# LOGIN_STRING\n# NO_PASSWORD_CONSOLE\n# QMAIL_DIR\n\n\n\n" to match /^\s*PASS_MIN_DAYS\s+([7-9]|[1-9][0-9]*)/
     Diff:
     @@ -1,2 +1,339 @@
     -/^\s*PASS_MIN_DAYS\s+([7-9]|[1-9][0-9]*)/
     +#
     +# /etc/login.defs - Configuration control definitions for the login package.
     +#
     +# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.
     +# If unspecified, some arbitrary (and possibly incorrect) value will
     +# be assumed.  All other items are optional - if not specified then
     +# the described action or option will be inhibited.
     +#
     +# Comment lines (lines beginning with "#") and blank lines are ignored.
     +#
     +# Modified for Linux.  --marekm
     +
     +# REQUIRED for useradd/userdel/usermod
     +#   Directory where mailboxes reside, _or_ name of file, relative to the
     +#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,
     +#   MAIL_DIR takes precedence.
     +#
     +#   Essentially:
     +#      - MAIL_DIR defines the location of users mail spool files
     +#        (for mbox use) by appending the username to MAIL_DIR as defined
     +#        below.
     +#      - MAIL_FILE defines the location of the users mail spool files as the
     +#        fully-qualified filename obtained by prepending the user home
     +#        directory before $MAIL_FILE
     +#
     +# NOTE: This is no more used for setting up users MAIL environment variable
     +#       which is, starting from shadow 4.0.12-1 in Debian, entirely the
     +#       job of the pam_mail PAM modules
     +#       See default PAM configuration files provided for
     +#       login, su, etc.
     +#
     +# This is a temporary situation: setting these variables will soon
     +# move to /etc/default/useradd and the variables will then be
     +# no more supported
     +MAIL_DIR        /var/mail
     +#MAIL_FILE      .mail
     +
     +#
     +# Enable logging and display of /var/log/faillog login failure info.
     +# This option conflicts with the pam_tally PAM module.
     +#
     +FAILLOG_ENAB		yes
     +
     +#
     +# Enable display of unknown usernames when login failures are recorded.
     +#
     +# WARNING: Unknown usernames may become world readable. 
     +# See #290803 and #298773 for details about how this could become a security
     +# concern
     +LOG_UNKFAIL_ENAB	no
     +
     +#
     +# Enable logging of successful logins
     +#
     +LOG_OK_LOGINS		no
     +
     +#
     +# Enable "syslog" logging of su activity - in addition to sulog file logging.
     +# SYSLOG_SG_ENAB does the same for newgrp and sg.
     +#
     +SYSLOG_SU_ENAB		yes
     +SYSLOG_SG_ENAB		yes
     +
     +#
     +# If defined, all su activity is logged to this file.
     +#
     +#SULOG_FILE	/var/log/sulog
     +
     +#
     +# If defined, file which maps tty line to TERM environment parameter.
     +# Each line of the file is in a format something like "vt100  tty01".
     +#
     +#TTYTYPE_FILE	/etc/ttytype
     +
     +#
     +# If defined, login failures will be logged here in a utmp format
     +# last, when invoked as lastb, will read /var/log/btmp, so...
     +#
     +FTMP_FILE	/var/log/btmp
     +
     +#
     +# If defined, the command name to display when running "su -".  For
     +# example, if this is defined as "su" then a "ps" will display the
     +# command is "-su".  If not defined, then "ps" would display the
     +# name of the shell actually being run, e.g. something like "-sh".
     +#
     +SU_NAME		su
     +
     +#
     +# If defined, file which inhibits all the usual chatter during the login
     +# sequence.  If a full pathname, then hushed mode will be enabled if the
     +# user's name or shell are found in the file.  If not a full pathname, then
     +# hushed mode will be enabled if the file exists in the user's home directory.
     +#
     +HUSHLOGIN_FILE	.hushlogin
     +#HUSHLOGIN_FILE	/etc/hushlogins
     +
     +#
     +# *REQUIRED*  The default PATH settings, for superuser and normal users.
     +#
     +# (they are minimal, add the rest in the shell startup files)
     +ENV_SUPATH	PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
     +ENV_PATH	PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
     +
     +#
     +# Terminal permissions
     +#
     +#	TTYGROUP	Login tty will be assigned this group ownership.
     +#	TTYPERM		Login tty will be set to this permission.
     +#
     +# If you have a "write" program which is "setgid" to a special group
     +# which owns the terminals, define TTYGROUP to the group number and
     +# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign
     +# TTYPERM to either 622 or 600.
     +#
     +# In Debian /usr/bin/bsd-write or similar programs are setgid tty
     +# However, the default and recommended value for TTYPERM is still 0600
     +# to not allow anyone to write to anyone else console or terminal
     +
     +# Users can still allow other people to write them by issuing 
     +# the "mesg y" command.
     +
     +TTYGROUP	tty
     +TTYPERM		0600
     +
     +#
     +# Login configuration initializations:
     +#
     +#	ERASECHAR	Terminal ERASE character ('\010' = backspace).
     +#	KILLCHAR	Terminal KILL character ('\025' = CTRL/U).
     +#	UMASK		Default "umask" value.
     +#
     +# The ERASECHAR and KILLCHAR are used only on System V machines.
     +# 
     +# UMASK is the default umask value for pam_umask and is used by
     +# useradd and newusers to set the mode of the new home directories.
     +# 022 is the "historical" value in Debian for UMASK
     +# 027, or even 077, could be considered better for privacy
     +# There is no One True Answer here : each sysadmin must make up his/her
     +# mind.
     +#
     +# If USERGROUPS_ENAB is set to "yes", that will modify this UMASK default value
     +# for private user groups, i. e. the uid is the same as gid, and username is
     +# the same as the primary group name: for these, the user permissions will be
     +# used as group permissions, e. g. 022 will become 002.
     +#
     +# Prefix these values with "0" to get octal, "0x" to get hexadecimal.
     +#
     +ERASECHAR	0177
     +KILLCHAR	025
     +UMASK		022
     +
     +#
     +# Password aging controls:
     +#
     +#	PASS_MAX_DAYS	Maximum number of days a password may be used.
     +#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
     +#	PASS_WARN_AGE	Number of days warning given before a password expires.
     +#
     +PASS_MAX_DAYS	99999
     +PASS_MIN_DAYS	0
     +PASS_WARN_AGE	7
     +
     +#
     +# Min/max values for automatic uid selection in useradd
     +#
     +UID_MIN			 1000
     +UID_MAX			60000
     +# System accounts
     +#SYS_UID_MIN		  100
     +#SYS_UID_MAX		  999
     +
     +#
     +# Min/max values for automatic gid selection in groupadd
     +#
     +GID_MIN			 1000
     +GID_MAX			60000
     +# System accounts
     +#SYS_GID_MIN		  100
     +#SYS_GID_MAX		  999
     +
     +#
     +# Max number of login retries if password is bad. This will most likely be
     +# overriden by PAM, since the default pam_unix module has it's own built
     +# in of 3 retries. However, this is a safe fallback in case you are using
     +# an authentication module that does not enforce PAM_MAXTRIES.
     +#
     +LOGIN_RETRIES		5
     +
     +#
     +# Max time in seconds for login
     +#
     +LOGIN_TIMEOUT		60
     +
     +#
     +# Which fields may be changed by regular users using chfn - use
     +# any combination of letters "frwh" (full name, room number, work
     +# phone, home phone).  If not defined, no changes are allowed.
     +# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
     +# 
     +CHFN_RESTRICT		rwh
     +
     +#
     +# Should login be allowed if we can't cd to the home directory?
     +# Default in no.
     +#
     +DEFAULT_HOME	yes
     +
     +#
     +# If defined, this command is run when removing a user.
     +# It should remove any at/cron/print jobs etc. owned by
     +# the user to be removed (passed as the first argument).
     +#
     +#USERDEL_CMD	/usr/sbin/userdel_local
     +
     +#
     +# Enable setting of the umask group bits to be the same as owner bits
     +# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is
     +# the same as gid, and username is the same as the primary group name.
     +#
     +# If set to yes, userdel will remove the userÂ´s group if it contains no
     +# more members, and useradd will create by default a group with the name
     +# of the user.
     +#
     +USERGROUPS_ENAB yes
     +
     +#
     +# Instead of the real user shell, the program specified by this parameter
     +# will be launched, although its visible name (argv[0]) will be the shell's.
     +# The program may do whatever it wants (logging, additional authentification,
     +# banner, ...) before running the actual shell.
     +#
     +# FAKE_SHELL /bin/fakeshell
     +
     +#
     +# If defined, either full pathname of a file containing device names or
     +# a ":" delimited list of device names.  Root logins will be allowed only
     +# upon these devices.
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE	/etc/consoles
     +#CONSOLE	console:tty01:tty02:tty03:tty04
     +
     +#
     +# List of groups to add to the user's supplementary group set
     +# when logging in on the console (as determined by the CONSOLE
     +# setting).  Default is none.
     +#
     +# Use with caution - it is possible for users to gain permanent
     +# access to these groups, even when not logged in on the console.
     +# How to do it is left as an exercise for the reader...
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE_GROUPS		floppy:audio:cdrom
     +
     +#
     +# If set to "yes", new passwords will be encrypted using the MD5-based
     +# algorithm compatible with the one used by recent releases of FreeBSD.
     +# It supports passwords of unlimited length and longer salt strings.
     +# Set to "no" if you need to copy encrypted passwords to other systems
     +# which don't understand the new algorithm.  Default is "no".
     +#
     +# This variable is deprecated. You should use ENCRYPT_METHOD.
     +#
     +#MD5_CRYPT_ENAB	no
     +
     +#
     +# If set to MD5 , MD5-based algorithm will be used for encrypting password
     +# If set to SHA256, SHA256-based algorithm will be used for encrypting password
     +# If set to SHA512, SHA512-based algorithm will be used for encrypting password
     +# If set to DES, DES-based algorithm will be used for encrypting password (default)
     +# Overrides the MD5_CRYPT_ENAB option
     +#
     +# Note: It is recommended to use a value consistent with
     +# the PAM modules configuration.
     +#
     +ENCRYPT_METHOD SHA512
     +
     +#
     +# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.
     +#
     +# Define the number of SHA rounds.
     +# With a lot of rounds, it is more difficult to brute forcing the password.
     +# But note also that it more CPU resources will be needed to authenticate
     +# users.
     +#
     +# If not specified, the libc will choose the default number of rounds (5000).
     +# The values must be inside the 1000-999999999 range.
     +# If only one of the MIN or MAX values is set, then this value will be used.
     +# If MIN > MAX, the highest value will be used.
     +#
     +# SHA_CRYPT_MIN_ROUNDS 5000
     +# SHA_CRYPT_MAX_ROUNDS 5000
     +
     +################# OBSOLETED BY PAM ##############
     +#						#
     +# These options are now handled by PAM. Please	#
     +# edit the appropriate file in /etc/pam.d/ to	#
     +# enable the equivelants of them.
     +#
     +###############
     +
     +#MOTD_FILE
     +#DIALUPS_CHECK_ENAB
     +#LASTLOG_ENAB
     +#MAIL_CHECK_ENAB
     +#OBSCURE_CHECKS_ENAB
     +#PORTTIME_CHECKS_ENAB
     +#SU_WHEEL_ONLY
     +#CRACKLIB_DICTPATH
     +#PASS_CHANGE_TRIES
     +#PASS_ALWAYS_WARN
     +#ENVIRON_FILE
     +#NOLOGINS_FILE
     +#ISSUE_FILE
     +#PASS_MIN_LEN
     +#PASS_MAX_LEN
     +#ULIMIT
     +#ENV_HZ
     +#CHFN_AUTH
     +#CHSH_AUTH
     +#FAIL_DELAY
     +
     +################# OBSOLETED #######################
     +#						  #
     +# These options are no more handled by shadow.    #
     +#                                                 #
     +# Shadow utilities will display a warning if they #
     +# still appear.                                   #
     +#                                                 #
     +###################################################
     +
     +# CLOSE_SESSIONS
     +# LOGIN_STRING
     +# NO_PASSWORD_CONSOLE
     +# QMAIL_DIR
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_10.1.3_Set_Password_Expiring_Warning_Days: File /etc/login.defs content should match /^\s*PASS_WARN_AGE\s+([7-9]|[1-9][0-9]+)/[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_10.2_Disable_System_Accounts: Bash command egrep -v "^\+" /etc/passwd | awk -F: '($1!="root" && $1!="sync" && $1!="shutdown" && $1!="halt" && $3<500 && $7!="/usr/sbin/nologin" && $7!="/bin/false") {print}' stdout should not match /.+/expected "libuuid:x:100:101::/var/lib/libuuid:\n" not to match /.+/
     Diff:
     @@ -1,2 +1,2 @@
     -/.+/
     +libuuid:x:100:101::/var/lib/libuuid:
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_10.3_Set_Default_Group_for_root_Account: Bash command grep "^root:" /etc/passwd | cut -f4 -d: stdout should match /^0$/[0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_10.4_Set_Default_umask_for_Users: File /etc/login.defs content should match /^UMASK\s+077$/expected "#\n# /etc/login.defs - Configuration control definitions for the login package.\n#\n# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.\n# If unspecified, some arbitrary (and possibly incorrect) value will\n# be assumed.  All other items are optional - if not specified then\n# the described action or option will be inhibited.\n#\n# Comment lines (lines beginning with \"#\") and blank lines are ignored.\n#\n# Modified for Linux.  --marekm\n\n# REQUIRED for useradd/userdel/usermod\n#   Directory where mailboxes reside, _or_ name of file, relative to the\n#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,\n#   MAIL_DIR takes precedence.\n#\n#   Essentially:\n#      - MAIL_DIR defines the location of users mail spool files\n#        (for mbox use) by appending the username to MAIL_DIR as defined\n#        below.\n#      - MAIL_FILE defines the location of the users mail spool files as the\n#        fully-qualified filename obtained by prepending the user home\n#        directory before $MAIL_FILE\n#\n# NOTE: This is no more used for setting up users MAIL environment variable\n#       which is, starting from shadow 4.0.12-1 in Debian, entirely the\n#       job of the pam_mail PAM modules\n#       See default PAM configuration files provided for\n#       login, su, etc.\n#\n# This is a temporary situation: setting these variables will soon\n# move to /etc/default/useradd and the variables will then be\n# no more supported\nMAIL_DIR        /var/mail\n#MAIL_FILE      .mail\n\n#\n# Enable logging and display of /var/log/faillog login failure info.\n# This option conflicts with the pam_tally PAM module.\n#\nFAILLOG_ENAB\t\tyes\n\n#\n# Enable display of unknown usernames when login failures are recorded.\n#\n# WARNING: Unknown usernames may become world readable. \n# See #290803 and #298773 for details about how this could become a security\n# concern\nLOG_UNKFAIL_ENAB\tno\n\n#\n# Enable logging of successful logins\n#\nLOG_OK_LOGINS\t\tno\n\n#\n# Enable \"syslog\" logging of su activity - in addition to sulog file logging.\n# SYSLOG_SG_ENAB does the same for newgrp and sg.\n#\nSYSLOG_SU_ENAB\t\tyes\nSYSLOG_SG_ENAB\t\tyes\n\n#\n# If defined, all su activity is logged to this file.\n#\n#SULOG_FILE\t/var/log/sulog\n\n#\n# If defined, file which maps tty line to TERM environment parameter.\n# Each line of the file is in a format something like \"vt100  tty01\".\n#\n#TTYTYPE_FILE\t/etc/ttytype\n\n#\n# If defined, login failures will be logged here in a utmp format\n# last, when invoked as lastb, will read /var/log/btmp, so...\n#\nFTMP_FILE\t/var/log/btmp\n\n#\n# If defined, the command name to display when running \"su -\".  For\n# example, if this is defined as \"su\" then a \"ps\" will display the\n# command is \"-su\".  If not defined, then \"ps\" would display the\n# name of the shell actually being run, e.g. something like \"-sh\".\n#\nSU_NAME\t\tsu\n\n#\n# If defined, file which inhibits all the usual chatter during the login\n# sequence.  If a full pathname, then hushed mode will be enabled if the\n# user's name or shell are found in the file.  If not a full pathname, then\n# hushed mode will be enabled if the file exists in the user's home directory.\n#\nHUSHLOGIN_FILE\t.hushlogin\n#HUSHLOGIN_FILE\t/etc/hushlogins\n\n#\n# *REQUIRED*  The default PATH settings, for superuser and normal users.\n#\n# (they are minimal, add the rest in the shell startup files)\nENV_SUPATH\tPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nENV_PATH\tPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games\n\n#\n# Terminal permissions\n#\n#\tTTYGROUP\tLogin tty will be assigned this group ownership.\n#\tTTYPERM\t\tLogin tty will be set to this permission.\n#\n# If you have a \"write\" program which is \"setgid\" to a special group\n# which owns the terminals, define TTYGROUP to the group number and\n# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign\n# TTYPERM to either 622 or 600.\n#\n# In Debian /usr/bin/bsd-write or similar programs are setgid tty\n# However, the default and recommended value for TTYPERM is still 0600\n# to not allow anyone to write to anyone else console or terminal\n\n# Users can still allow other people to write them by issuing \n# the \"mesg y\" command.\n\nTTYGROUP\ttty\nTTYPERM\t\t0600\n\n#\n# Login configuration initializations:\n#\n#\tERASECHAR\tTerminal ERASE character ('\\010' = backspace).\n#\tKILLCHAR\tTerminal KILL character ('\\025' = CTRL/U).\n#\tUMASK\t\tDefault \"umask\" value.\n#\n# The ERASECHAR and KILLCHAR are used only on System V machines.\n# \n# UMASK is the default umask value for pam_umask and is used by\n# useradd and newusers to set the mode of the new home directories.\n# 022 is the \"historical\" value in Debian for UMASK\n# 027, or even 077, could be considered better for privacy\n# There is no One True Answer here : each sysadmin must make up his/her\n# mind.\n#\n# If USERGROUPS_ENAB is set to \"yes\", that will modify this UMASK default value\n# for private user groups, i. e. the uid is the same as gid, and username is\n# the same as the primary group name: for these, the user permissions will be\n# used as group permissions, e. g. 022 will become 002.\n#\n# Prefix these values with \"0\" to get octal, \"0x\" to get hexadecimal.\n#\nERASECHAR\t0177\nKILLCHAR\t025\nUMASK\t\t022\n\n#\n# Password aging controls:\n#\n#\tPASS_MAX_DAYS\tMaximum number of days a password may be used.\n#\tPASS_MIN_DAYS\tMinimum number of days allowed between password changes.\n#\tPASS_WARN_AGE\tNumber of days warning given before a password expires.\n#\nPASS_MAX_DAYS\t99999\nPASS_MIN_DAYS\t0\nPASS_WARN_AGE\t7\n\n#\n# Min/max values for automatic uid selection in useradd\n#\nUID_MIN\t\t\t 1000\nUID_MAX\t\t\t60000\n# System accounts\n#SYS_UID_MIN\t\t  100\n#SYS_UID_MAX\t\t  999\n\n#\n# Min/max values for automatic gid selection in groupadd\n#\nGID_MIN\t\t\t 1000\nGID_MAX\t\t\t60000\n# System accounts\n#SYS_GID_MIN\t\t  100\n#SYS_GID_MAX\t\t  999\n\n#\n# Max number of login retries if password is bad. This will most likely be\n# overriden by PAM, since the default pam_unix module has it's own built\n# in of 3 retries. However, this is a safe fallback in case you are using\n# an authentication module that does not enforce PAM_MAXTRIES.\n#\nLOGIN_RETRIES\t\t5\n\n#\n# Max time in seconds for login\n#\nLOGIN_TIMEOUT\t\t60\n\n#\n# Which fields may be changed by regular users using chfn - use\n# any combination of letters \"frwh\" (full name, room number, work\n# phone, home phone).  If not defined, no changes are allowed.\n# For backward compatibility, \"yes\" = \"rwh\" and \"no\" = \"frwh\".\n# \nCHFN_RESTRICT\t\trwh\n\n#\n# Should login be allowed if we can't cd to the home directory?\n# Default in no.\n#\nDEFAULT_HOME\tyes\n\n#\n# If defined, this command is run when removing a user.\n# It should remove any at/cron/print jobs etc. owned by\n# the user to be removed (passed as the first argument).\n#\n#USERDEL_CMD\t/usr/sbin/userdel_local\n\n#\n# Enable setting of the umask group bits to be the same as owner bits\n# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is\n# the same as gid, and username is the same as the primary group name.\n#\n# If set to yes, userdel will remove the userÂ´s group if it contains no\n# more members, and useradd will create by default a group with the name\n# of the user.\n#\nUSERGROUPS_ENAB yes\n\n#\n# Instead of the real user shell, the program specified by this parameter\n# will be launched, although its visible name (argv[0]) will be the shell's.\n# The program may do whatever it wants (logging, additional authentification,\n# banner, ...) before running the actual shell.\n#\n# FAKE_SHELL /bin/fakeshell\n\n#\n# If defined, either full pathname of a file containing device names or\n# a \":\" delimited list of device names.  Root logins will be allowed only\n# upon these devices.\n#\n# This variable is used by login and su.\n#\n#CONSOLE\t/etc/consoles\n#CONSOLE\tconsole:tty01:tty02:tty03:tty04\n\n#\n# List of groups to add to the user's supplementary group set\n# when logging in on the console (as determined by the CONSOLE\n# setting).  Default is none.\n#\n# Use with caution - it is possible for users to gain permanent\n# access to these groups, even when not logged in on the console.\n# How to do it is left as an exercise for the reader...\n#\n# This variable is used by login and su.\n#\n#CONSOLE_GROUPS\t\tfloppy:audio:cdrom\n\n#\n# If set to \"yes\", new passwords will be encrypted using the MD5-based\n# algorithm compatible with the one used by recent releases of FreeBSD.\n# It supports passwords of unlimited length and longer salt strings.\n# Set to \"no\" if you need to copy encrypted passwords to other systems\n# which don't understand the new algorithm.  Default is \"no\".\n#\n# This variable is deprecated. You should use ENCRYPT_METHOD.\n#\n#MD5_CRYPT_ENAB\tno\n\n#\n# If set to MD5 , MD5-based algorithm will be used for encrypting password\n# If set to SHA256, SHA256-based algorithm will be used for encrypting password\n# If set to SHA512, SHA512-based algorithm will be used for encrypting password\n# If set to DES, DES-based algorithm will be used for encrypting password (default)\n# Overrides the MD5_CRYPT_ENAB option\n#\n# Note: It is recommended to use a value consistent with\n# the PAM modules configuration.\n#\nENCRYPT_METHOD SHA512\n\n#\n# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.\n#\n# Define the number of SHA rounds.\n# With a lot of rounds, it is more difficult to brute forcing the password.\n# But note also that it more CPU resources will be needed to authenticate\n# users.\n#\n# If not specified, the libc will choose the default number of rounds (5000).\n# The values must be inside the 1000-999999999 range.\n# If only one of the MIN or MAX values is set, then this value will be used.\n# If MIN > MAX, the highest value will be used.\n#\n# SHA_CRYPT_MIN_ROUNDS 5000\n# SHA_CRYPT_MAX_ROUNDS 5000\n\n################# OBSOLETED BY PAM ##############\n#\t\t\t\t\t\t#\n# These options are now handled by PAM. Please\t#\n# edit the appropriate file in /etc/pam.d/ to\t#\n# enable the equivelants of them.\n#\n###############\n\n#MOTD_FILE\n#DIALUPS_CHECK_ENAB\n#LASTLOG_ENAB\n#MAIL_CHECK_ENAB\n#OBSCURE_CHECKS_ENAB\n#PORTTIME_CHECKS_ENAB\n#SU_WHEEL_ONLY\n#CRACKLIB_DICTPATH\n#PASS_CHANGE_TRIES\n#PASS_ALWAYS_WARN\n#ENVIRON_FILE\n#NOLOGINS_FILE\n#ISSUE_FILE\n#PASS_MIN_LEN\n#PASS_MAX_LEN\n#ULIMIT\n#ENV_HZ\n#CHFN_AUTH\n#CHSH_AUTH\n#FAIL_DELAY\n\n################# OBSOLETED #######################\n#\t\t\t\t\t\t  #\n# These options are no more handled by shadow.    #\n#                                                 #\n# Shadow utilities will display a warning if they #\n# still appear.                                   #\n#                                                 #\n###################################################\n\n# CLOSE_SESSIONS\n# LOGIN_STRING\n# NO_PASSWORD_CONSOLE\n# QMAIL_DIR\n\n\n\n" to match /^UMASK\s+077$/
     Diff:
     @@ -1,2 +1,339 @@
     -/^UMASK\s+077$/
     +#
     +# /etc/login.defs - Configuration control definitions for the login package.
     +#
     +# Three items must be defined:  MAIL_DIR, ENV_SUPATH, and ENV_PATH.
     +# If unspecified, some arbitrary (and possibly incorrect) value will
     +# be assumed.  All other items are optional - if not specified then
     +# the described action or option will be inhibited.
     +#
     +# Comment lines (lines beginning with "#") and blank lines are ignored.
     +#
     +# Modified for Linux.  --marekm
     +
     +# REQUIRED for useradd/userdel/usermod
     +#   Directory where mailboxes reside, _or_ name of file, relative to the
     +#   home directory.  If you _do_ define MAIL_DIR and MAIL_FILE,
     +#   MAIL_DIR takes precedence.
     +#
     +#   Essentially:
     +#      - MAIL_DIR defines the location of users mail spool files
     +#        (for mbox use) by appending the username to MAIL_DIR as defined
     +#        below.
     +#      - MAIL_FILE defines the location of the users mail spool files as the
     +#        fully-qualified filename obtained by prepending the user home
     +#        directory before $MAIL_FILE
     +#
     +# NOTE: This is no more used for setting up users MAIL environment variable
     +#       which is, starting from shadow 4.0.12-1 in Debian, entirely the
     +#       job of the pam_mail PAM modules
     +#       See default PAM configuration files provided for
     +#       login, su, etc.
     +#
     +# This is a temporary situation: setting these variables will soon
     +# move to /etc/default/useradd and the variables will then be
     +# no more supported
     +MAIL_DIR        /var/mail
     +#MAIL_FILE      .mail
     +
     +#
     +# Enable logging and display of /var/log/faillog login failure info.
     +# This option conflicts with the pam_tally PAM module.
     +#
     +FAILLOG_ENAB		yes
     +
     +#
     +# Enable display of unknown usernames when login failures are recorded.
     +#
     +# WARNING: Unknown usernames may become world readable. 
     +# See #290803 and #298773 for details about how this could become a security
     +# concern
     +LOG_UNKFAIL_ENAB	no
     +
     +#
     +# Enable logging of successful logins
     +#
     +LOG_OK_LOGINS		no
     +
     +#
     +# Enable "syslog" logging of su activity - in addition to sulog file logging.
     +# SYSLOG_SG_ENAB does the same for newgrp and sg.
     +#
     +SYSLOG_SU_ENAB		yes
     +SYSLOG_SG_ENAB		yes
     +
     +#
     +# If defined, all su activity is logged to this file.
     +#
     +#SULOG_FILE	/var/log/sulog
     +
     +#
     +# If defined, file which maps tty line to TERM environment parameter.
     +# Each line of the file is in a format something like "vt100  tty01".
     +#
     +#TTYTYPE_FILE	/etc/ttytype
     +
     +#
     +# If defined, login failures will be logged here in a utmp format
     +# last, when invoked as lastb, will read /var/log/btmp, so...
     +#
     +FTMP_FILE	/var/log/btmp
     +
     +#
     +# If defined, the command name to display when running "su -".  For
     +# example, if this is defined as "su" then a "ps" will display the
     +# command is "-su".  If not defined, then "ps" would display the
     +# name of the shell actually being run, e.g. something like "-sh".
     +#
     +SU_NAME		su
     +
     +#
     +# If defined, file which inhibits all the usual chatter during the login
     +# sequence.  If a full pathname, then hushed mode will be enabled if the
     +# user's name or shell are found in the file.  If not a full pathname, then
     +# hushed mode will be enabled if the file exists in the user's home directory.
     +#
     +HUSHLOGIN_FILE	.hushlogin
     +#HUSHLOGIN_FILE	/etc/hushlogins
     +
     +#
     +# *REQUIRED*  The default PATH settings, for superuser and normal users.
     +#
     +# (they are minimal, add the rest in the shell startup files)
     +ENV_SUPATH	PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
     +ENV_PATH	PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
     +
     +#
     +# Terminal permissions
     +#
     +#	TTYGROUP	Login tty will be assigned this group ownership.
     +#	TTYPERM		Login tty will be set to this permission.
     +#
     +# If you have a "write" program which is "setgid" to a special group
     +# which owns the terminals, define TTYGROUP to the group number and
     +# TTYPERM to 0620.  Otherwise leave TTYGROUP commented out and assign
     +# TTYPERM to either 622 or 600.
     +#
     +# In Debian /usr/bin/bsd-write or similar programs are setgid tty
     +# However, the default and recommended value for TTYPERM is still 0600
     +# to not allow anyone to write to anyone else console or terminal
     +
     +# Users can still allow other people to write them by issuing 
     +# the "mesg y" command.
     +
     +TTYGROUP	tty
     +TTYPERM		0600
     +
     +#
     +# Login configuration initializations:
     +#
     +#	ERASECHAR	Terminal ERASE character ('\010' = backspace).
     +#	KILLCHAR	Terminal KILL character ('\025' = CTRL/U).
     +#	UMASK		Default "umask" value.
     +#
     +# The ERASECHAR and KILLCHAR are used only on System V machines.
     +# 
     +# UMASK is the default umask value for pam_umask and is used by
     +# useradd and newusers to set the mode of the new home directories.
     +# 022 is the "historical" value in Debian for UMASK
     +# 027, or even 077, could be considered better for privacy
     +# There is no One True Answer here : each sysadmin must make up his/her
     +# mind.
     +#
     +# If USERGROUPS_ENAB is set to "yes", that will modify this UMASK default value
     +# for private user groups, i. e. the uid is the same as gid, and username is
     +# the same as the primary group name: for these, the user permissions will be
     +# used as group permissions, e. g. 022 will become 002.
     +#
     +# Prefix these values with "0" to get octal, "0x" to get hexadecimal.
     +#
     +ERASECHAR	0177
     +KILLCHAR	025
     +UMASK		022
     +
     +#
     +# Password aging controls:
     +#
     +#	PASS_MAX_DAYS	Maximum number of days a password may be used.
     +#	PASS_MIN_DAYS	Minimum number of days allowed between password changes.
     +#	PASS_WARN_AGE	Number of days warning given before a password expires.
     +#
     +PASS_MAX_DAYS	99999
     +PASS_MIN_DAYS	0
     +PASS_WARN_AGE	7
     +
     +#
     +# Min/max values for automatic uid selection in useradd
     +#
     +UID_MIN			 1000
     +UID_MAX			60000
     +# System accounts
     +#SYS_UID_MIN		  100
     +#SYS_UID_MAX		  999
     +
     +#
     +# Min/max values for automatic gid selection in groupadd
     +#
     +GID_MIN			 1000
     +GID_MAX			60000
     +# System accounts
     +#SYS_GID_MIN		  100
     +#SYS_GID_MAX		  999
     +
     +#
     +# Max number of login retries if password is bad. This will most likely be
     +# overriden by PAM, since the default pam_unix module has it's own built
     +# in of 3 retries. However, this is a safe fallback in case you are using
     +# an authentication module that does not enforce PAM_MAXTRIES.
     +#
     +LOGIN_RETRIES		5
     +
     +#
     +# Max time in seconds for login
     +#
     +LOGIN_TIMEOUT		60
     +
     +#
     +# Which fields may be changed by regular users using chfn - use
     +# any combination of letters "frwh" (full name, room number, work
     +# phone, home phone).  If not defined, no changes are allowed.
     +# For backward compatibility, "yes" = "rwh" and "no" = "frwh".
     +# 
     +CHFN_RESTRICT		rwh
     +
     +#
     +# Should login be allowed if we can't cd to the home directory?
     +# Default in no.
     +#
     +DEFAULT_HOME	yes
     +
     +#
     +# If defined, this command is run when removing a user.
     +# It should remove any at/cron/print jobs etc. owned by
     +# the user to be removed (passed as the first argument).
     +#
     +#USERDEL_CMD	/usr/sbin/userdel_local
     +
     +#
     +# Enable setting of the umask group bits to be the same as owner bits
     +# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is
     +# the same as gid, and username is the same as the primary group name.
     +#
     +# If set to yes, userdel will remove the userÂ´s group if it contains no
     +# more members, and useradd will create by default a group with the name
     +# of the user.
     +#
     +USERGROUPS_ENAB yes
     +
     +#
     +# Instead of the real user shell, the program specified by this parameter
     +# will be launched, although its visible name (argv[0]) will be the shell's.
     +# The program may do whatever it wants (logging, additional authentification,
     +# banner, ...) before running the actual shell.
     +#
     +# FAKE_SHELL /bin/fakeshell
     +
     +#
     +# If defined, either full pathname of a file containing device names or
     +# a ":" delimited list of device names.  Root logins will be allowed only
     +# upon these devices.
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE	/etc/consoles
     +#CONSOLE	console:tty01:tty02:tty03:tty04
     +
     +#
     +# List of groups to add to the user's supplementary group set
     +# when logging in on the console (as determined by the CONSOLE
     +# setting).  Default is none.
     +#
     +# Use with caution - it is possible for users to gain permanent
     +# access to these groups, even when not logged in on the console.
     +# How to do it is left as an exercise for the reader...
     +#
     +# This variable is used by login and su.
     +#
     +#CONSOLE_GROUPS		floppy:audio:cdrom
     +
     +#
     +# If set to "yes", new passwords will be encrypted using the MD5-based
     +# algorithm compatible with the one used by recent releases of FreeBSD.
     +# It supports passwords of unlimited length and longer salt strings.
     +# Set to "no" if you need to copy encrypted passwords to other systems
     +# which don't understand the new algorithm.  Default is "no".
     +#
     +# This variable is deprecated. You should use ENCRYPT_METHOD.
     +#
     +#MD5_CRYPT_ENAB	no
     +
     +#
     +# If set to MD5 , MD5-based algorithm will be used for encrypting password
     +# If set to SHA256, SHA256-based algorithm will be used for encrypting password
     +# If set to SHA512, SHA512-based algorithm will be used for encrypting password
     +# If set to DES, DES-based algorithm will be used for encrypting password (default)
     +# Overrides the MD5_CRYPT_ENAB option
     +#
     +# Note: It is recommended to use a value consistent with
     +# the PAM modules configuration.
     +#
     +ENCRYPT_METHOD SHA512
     +
     +#
     +# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.
     +#
     +# Define the number of SHA rounds.
     +# With a lot of rounds, it is more difficult to brute forcing the password.
     +# But note also that it more CPU resources will be needed to authenticate
     +# users.
     +#
     +# If not specified, the libc will choose the default number of rounds (5000).
     +# The values must be inside the 1000-999999999 range.
     +# If only one of the MIN or MAX values is set, then this value will be used.
     +# If MIN > MAX, the highest value will be used.
     +#
     +# SHA_CRYPT_MIN_ROUNDS 5000
     +# SHA_CRYPT_MAX_ROUNDS 5000
     +
     +################# OBSOLETED BY PAM ##############
     +#						#
     +# These options are now handled by PAM. Please	#
     +# edit the appropriate file in /etc/pam.d/ to	#
     +# enable the equivelants of them.
     +#
     +###############
     +
     +#MOTD_FILE
     +#DIALUPS_CHECK_ENAB
     +#LASTLOG_ENAB
     +#MAIL_CHECK_ENAB
     +#OBSCURE_CHECKS_ENAB
     +#PORTTIME_CHECKS_ENAB
     +#SU_WHEEL_ONLY
     +#CRACKLIB_DICTPATH
     +#PASS_CHANGE_TRIES
     +#PASS_ALWAYS_WARN
     +#ENVIRON_FILE
     +#NOLOGINS_FILE
     +#ISSUE_FILE
     +#PASS_MIN_LEN
     +#PASS_MAX_LEN
     +#ULIMIT
     +#ENV_HZ
     +#CHFN_AUTH
     +#CHSH_AUTH
     +#FAIL_DELAY
     +
     +################# OBSOLETED #######################
     +#						  #
     +# These options are no more handled by shadow.    #
     +#                                                 #
     +# Shadow utilities will display a warning if they #
     +# still appear.                                   #
     +#                                                 #
     +###################################################
     +
     +# CLOSE_SESSIONS
     +# LOGIN_STRING
     +# NO_PASSWORD_CONSOLE
     +# QMAIL_DIR
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_10.5_Lock_Inactive_User_Accounts: Bash command useradd -D | grep INACTIVE stdout should match /^INACTIVE=35$/expected "INACTIVE=-1\n" to match /^INACTIVE=35$/
     Diff:
     @@ -1,2 +1,2 @@
     -/^INACTIVE=35$/
     +INACTIVE=-1
     [0m
[31m  âœ–  xccdf_org.cisecurity.benchmarks_rule_11.1_Set_Warning_Banner_for_Standard_Login_Services:  should eq "0000"
     expected: "0000"
          got: nil
     
     (compared using ==)
     [0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_11.2_Remove_OS_Information_from_Login_Warning_Banners: File /etc/motd content should not match /(\\v|\\r|\\m|\\s)/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.1_Verify_Permissions_on_etcpasswd: 0000 should eq "0000"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.2_Verify_Permissions_on_etcshadow: 0000 should eq "0000"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.3_Verify_Permissions_on_etcgroup: 0000 should eq "0000"[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.4_Verify_UserGroup_Ownership_on_etcpasswd: Bash command stat -c "%u %g" /etc/passwd stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.5_Verify_UserGroup_Ownership_on_etcshadow: Bash command stat -c "%u %g" /etc/shadow stdout should match /0 (0|42)/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.6_Verify_UserGroup_Ownership_on_etcgroup: Bash command stat -c "%u %g" /etc/group stdout should match /0 0/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.7_Find_World_Writable_Files: Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 -print stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.8_Find_Un-owned_Files_and_Directories: Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser -ls stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_12.9_Find_Un-grouped_Files_and_Directories: Bash command df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup -ls stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.1_Ensure_Password_Fields_are_Not_Empty: Bash command cat /etc/shadow | awk -F: '($2 == "" ) { print $1 " does not have a password "}' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.2_Verify_No_Legacy__Entries_Exist_in_etcpasswd_File: File /etc/passwd content should not match /^\+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.3_Verify_No_Legacy__Entries_Exist_in_etcshadow_File: File /etc/shadow content should not match /^\+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.4_Verify_No_Legacy__Entries_Exist_in_etcgroup_File: File /etc/group content should not match /^\+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.5_Verify_No_UID_0_Accounts_Exist_Other_Than_root: Bash command /bin/cat /etc/passwd | /bin/awk -F: '($3 == 0) { print $1 }' | grep -v 'root' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.6_Ensure_root_PATH_Integrity: Bash command echo $PATH stdout should not match /(^|:):/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.7_Check_Permissions_on_User_Home_Directories: Bash command for i in $(awk -F: '($7 != "/usr/sbin/nologin" && $3 >= 500) {print $6}' /etc/passwd | sort -u); do echo $i $(stat -L --format=%a $i) | grep -v ' .[0145][0145]$';done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.8_Check_User_Dot_File_Permissions: Bash command find `cat /etc/passwd | egrep -v "root|sync|halt|shutdown" | awk -F: '($7 != "/usr/sbin/nologin" && $7) {print $6}' | sort | uniq | grep -v "^/$"` -name ".*" -perm /go+w -follow stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.9_Check_Permissions_on_User_.netrc_Files: Bash command find `cat /etc/passwd | egrep -v "root|sync|halt|shutdown" | awk -F: '($7 != "/usr/sbin/nologin" && $7) {print $6}' | sort | uniq | grep -v "^/$"` -name ".netrc" -perm /go+w stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.10_Check_for_Presence_of_User_.rhosts_Files: Bash command cut -f6 -d: /etc/passwd | sort -u | while read DIR; do ls $DIR/.rhosts 2>/dev/null; done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.11_Check_Groups_in_etcpasswd: Bash command for i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do grep -q -P "^.*?:[^:]*:$i:" /etc/group; if [ $? -ne 0 ]; then echo "Group $i is referenced by /etc/passwd but does not exist in /etc/group"; fi; done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.12_Check_That_Users_Are_Assigned_Valid_Home_Directories: Bash command  cat /etc/passwd | awk -F: '{ print $1 " " $3 " " $6 }' | while read user uid dir; do if [ $uid -ge 500 -a ! -d "$dir" -a $user != "nfsnobody" -a $user != "nobody" ]; then echo "The home directory ($dir) of user $user does not exist."; fi; done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.13_Check_User_Home_Directory_Ownership: Bash command cat /etc/passwd | awk -F: '{ print $1 " " $3 " " $6 }' | while read user uid dir; do if [ $uid -ge 500 -a -d "$dir" -a $user != "nfsnobody" -a $user != "nobody" ]; then owner=$(stat -L -c "%U" "$dir"); if [ "$owner" != "$user" ]; then echo "The home directory ($dir) of user $user is owned by $owner."; fi; fi; done; stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.14_Check_for_Duplicate_UIDs: Bash command egrep -v "^\+" /etc/passwd | cut -f3 -d":" | sort -n | uniq -c | awk '{ if ($1 != 1) { print "Duplicate UID found: " $2 } }' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.15_Check_for_Duplicate_GIDs: Bash command egrep -v "^\+" /etc/group | cut -f3 -d":" | sort -n | uniq -c | awk '{ if ($1 != 1) { print "Duplicate GUID found: " $2 } }' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.16_Check_for_Duplicate_User_Names: Bash command egrep -v "^\+" /etc/passwd | cut -f1 -d":" | sort | uniq -c | awk '{ if ($1 != 1) { print "Duplicate User name Found: " $2 } }' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.17_Check_for_Duplicate_Group_Names: Bash command egrep -v "^\+" /etc/group | cut -f1 -d":" | sort -n | uniq -c | awk '{ if ($1 != 1) { print "Duplicate Group name Found: " $2 } }' stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.18_Check_for_Presence_of_User_.netrc_Files: Bash command egrep -v "^\+" /etc/passwd | cut -f6 -d: | sort -u | while read DIR; do ls $DIR/.netrc 2>/dev/null; done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.19_Check_for_Presence_of_User_.forward_Files: Bash command egrep -v "^\+" /etc/passwd | cut -f6 -d: | sort -u | while read D; do ls $D/.forward 2&gt;/dev/null; done stdout should not match /.+/[0m
[32m  âœ”  xccdf_org.cisecurity.benchmarks_rule_13.20_Ensure_shadow_group_is_empty: File /etc/group content should not match /^shadow:x:15:.+$/[0m


Profile: CIS Ubuntu 14.04 LTS Server Benchmark Level 1 (cis-ubuntu14.04lts-level1)
Version: 1.0.0
Target:  ssh://ubuntu@ec2-52-40-157-107.us-west-2.compute.amazonaws.com:22

     No tests executed.[0m

Summary: 120 successful   75 failures    0 skipped
>>>>>> ------Exception-------
>>>>>> Class: Kitchen::ActionFailed
>>>>>> Message: 1 actions failed.
>>>>>>     Verify failed on instance <default-ubuntu-1404>.  Please see .kitchen/logs/default-ubuntu-1404.log for more details
>>>>>> ----------------------
>>>>>> Please see .kitchen/logs/kitchen.log for more details
>>>>>> Also try running `kitchen diagnose --all` for configuration
